{"version":3,"sources":["../node_modules/react-modal/lib/index.js","../node_modules/react-modal/lib/helpers/safeHTMLElement.js","../node_modules/react-modal/node_modules/prop-types/index.js","../node_modules/react-modal/lib/helpers/tabbable.js","../node_modules/react-modal/lib/helpers/ariaAppHider.js","../node_modules/react-modal/lib/helpers/portalOpenInstances.js","../node_modules/qrcode.react/lib/index.js","../node_modules/qr.js/lib/mode.js","../node_modules/qr.js/lib/ErrorCorrectLevel.js","../node_modules/qr.js/lib/Polynomial.js","../node_modules/qr.js/lib/math.js","../node_modules/sdp/sdp.js","../node_modules/webrtc-adapter/src/js/utils.js","../node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","../node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","../node_modules/webrtc-adapter/src/js/edge/getusermedia.js","../node_modules/webrtc-adapter/src/js/edge/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/edge/edge_shim.js","../node_modules/webrtc-adapter/src/js/edge/filtericeservers.js","../node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","../node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","../node_modules/webrtc-adapter/src/js/safari/safari_shim.js","../node_modules/webrtc-adapter/src/js/common_shim.js","../node_modules/webrtc-adapter/src/js/adapter_core.js","../node_modules/webrtc-adapter/src/js/adapter_factory.js","../node_modules/react-modal/lib/components/Modal.js","../node_modules/react-modal/node_modules/prop-types/factoryWithThrowingShims.js","../node_modules/react-modal/node_modules/prop-types/lib/ReactPropTypesSecret.js","../node_modules/react-modal/lib/components/ModalPortal.js","../node_modules/react-modal/lib/helpers/focusManager.js","../node_modules/react-modal/lib/helpers/scopeTab.js","../node_modules/warning/warning.js","../node_modules/exenv/index.js","../node_modules/react-modal/lib/helpers/classList.js","../node_modules/react-modal/lib/helpers/bodyTrap.js","../node_modules/react-lifecycles-compat/react-lifecycles-compat.es.js","../node_modules/qrcode.react/node_modules/prop-types/index.js","../node_modules/qrcode.react/node_modules/prop-types/factoryWithThrowingShims.js","../node_modules/qrcode.react/node_modules/prop-types/lib/ReactPropTypesSecret.js","../node_modules/qr.js/lib/QRCode.js","../node_modules/qr.js/lib/8BitByte.js","../node_modules/qr.js/lib/RSBlock.js","../node_modules/qr.js/lib/BitBuffer.js","../node_modules/qr.js/lib/util.js","../node_modules/rtcpeerconnection-shim/rtcpeerconnection.js"],"names":["Object","defineProperty","exports","value","obj","_Modal","require","_Modal2","__esModule","default","module","canUseDOM","SafeNodeList","SafeHTMLCollection","undefined","_exenv","EE","SafeHTMLElement","window","HTMLElement","HTMLCollection","NodeList","findTabbableDescendants","element","descendants","slice","call","querySelectorAll","reduce","finished","el","concat","shadowRoot","filter","tabbable","tabbableNode","hidesContents","zeroSize","offsetWidth","offsetHeight","innerHTML","style","getComputedStyle","getPropertyValue","scrollWidth","scrollHeight","exception","console","warn","focusable","isTabIndexNotNaN","nodeName","toLowerCase","test","disabled","href","parentElement","rootNode","getRootNode","document","body","host","parentNode","visible","tabIndex","getAttribute","isTabIndexNaN","isNaN","resetState","globalElement","removeAttribute","length","forEach","log","process","assertNodeList","setElement","useElement","_safeHTMLElement","validateElement","hide","appElement","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","setAttribute","err","return","show","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","documentNotReadyOrSSRTesting","_warning","_warning2","nodeList","selector","Error","Array","isArray","join","portalOpenInstances","openInstances","p","PortalOpenInstances","_this","this","instance","Constructor","TypeError","_classCallCheck","register","openInstance","indexOf","push","emit","deregister","index","splice","subscribe","callback","subscribers","eventType","subscriber","_typeof","constructor","prototype","_extends","assign","target","i","arguments","source","key","hasOwnProperty","apply","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","_objectSpread","_defineProperty","getOwnPropertyDescriptors","defineProperties","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","sourceSymbolKeys","propertyIsEnumerable","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","ReferenceError","_inherits","subClass","superClass","create","_setPrototypeOf","React","QRCodeImpl","ErrorCorrectLevel","convertStr","str","out","charcode","charCodeAt","String","fromCharCode","DEFAULT_PROPS","size","level","bgColor","fgColor","includeMargin","generatePath","modules","margin","ops","row","y","start","cell","x","excavateModules","excavation","map","h","w","getImageSettings","cells","imageSettings","numCells","defaultSize","Math","floor","scale","width","height","excavate","floorX","floorY","ceil","SUPPORTS_PATH2D","Path2D","addPath","e","QRCodeCanvas","_React$PureComponent","_getPrototypeOf2","_len","args","_key","imgLoaded","setState","_image","complete","handleImageLoad","update","nextProps","_this$props$imageSett","_nextProps$imageSetti","src","_this$props","qrcode","addData","make","_canvas","canvas","ctx","getContext","calculatedImageSettings","pixelRatio","devicePixelRatio","fillStyle","fillRect","fill","rdx","cdx","state","drawImage","_this2","_this$props2","otherProps","canvasStyle","img","imgSrc","createElement","display","onLoad","ref","_ref","Fragment","_ref2","PureComponent","QRCodeSVG","_React$PureComponent2","_this$props3","image","xlinkHref","preserveAspectRatio","fgPath","shapeRendering","viewBox","d","QRCode","renderAs","Component","defaultProps","MODE_NUMBER","MODE_ALPHA_NUM","MODE_8BIT_BYTE","MODE_KANJI","L","M","Q","H","math","QRPolynomial","num","shift","offset","get","getLength","multiply","j","gexp","glog","mod","ratio","QRMath","n","LOG_TABLE","EXP_TABLE","SDPUtils","random","toString","substr","localCName","generateIdentifier","splitLines","blob","trim","split","line","splitSections","part","getDescription","sections","getMediaSections","matchPrefix","prefix","parseCandidate","parts","candidate","foundation","substring","component","parseInt","protocol","priority","ip","address","port","type","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","writeCandidate","sdp","toUpperCase","parseIceOptions","parseRtpMap","parsed","payloadType","name","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","id","direction","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","parameters","params","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","kind","caps","maxptime","extension","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","cname","rsize","reducedSize","compound","mux","parseMsid","spec","stream","track","planB","msidParts","parseSctpDescription","maxMessageSize","parseMLine","maxSizeLine","sctpPort","fmt","writeSctpDescription","media","sctp","output","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","version","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","rtpSender","rtpReceiver","msid","sendEncodingParameters","getDirection","getKind","isRejected","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","charAt","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","pos","match","wrapPeerConnectionEvent","eventNameToWrap","wrapper","RTCPeerConnection","proto","nativeAddEventListener","addEventListener","nativeEventName","cb","wrappedCallback","modifiedEvent","handleEvent","_eventMap","Map","set","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","delete","disableLog","bool","disableWarnings","deprecated","oldMethod","newMethod","detectBrowser","result","browser","navigator","mozGetUserMedia","userAgent","webkitGetUserMedia","isSecureContext","webkitRTCPeerConnection","RTCIceGatherer","mediaDevices","supportsUnifiedPlan","RTCRtpTransceiver","isObject","val","compactObject","data","accumulator","isObj","isEmptyObject","walkStats","stats","base","resultSet","endsWith","filterStats","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","logging","utils","shimGetUserMedia","browserDetails","constraintsToChrome_","c","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","oc","mix","advanced","shimConstraints_","constraints","func","audio","remap","a","b","video","face","facingMode","matches","getSupportedFacingModeLies","getSupportedConstraints","enumerateDevices","then","devices","dev","find","some","label","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia","onSuccess","onError","bind","origGetUserMedia","cs","getAudioTracks","getVideoTracks","getTracks","stop","DOMException","Promise","reject","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","heightSpecified","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","error","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","event","Event","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","pc","dtmf","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","shimGetStats","origGetStats","getStats","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","successCallbackWrapper_","resolve","shimSenderReceiverGetStats","RTCRtpReceiver","origGetReceivers","receivers","srcElement","MediaStreamTrack","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","signalingState","t","alreadyExists","oldStream","method","nativeMethod","methodObj","isLegacyCall","desc","replaceInternalStreamId","origSetLocalDescription","setLocalDescription","replaceExternalStreamId","origLocalDescription","streamid","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","shimPeerConnection","RTCIceCandidate","fixNegotiationNeeded","getConfiguration","sdpSemantics","catch","origMSTEnabled","ev","enabled","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","shimRTCPeerConnection","config","iceServers","edgeVersion","hasTurn","server","urls","url","isString","validTurn","startsWith","filterIceServers","shimReplaceTrack","replaceTrack","setTrack","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","preferredMediaSource","code","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","rid","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","getParameters","encodings","setParameters","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","createOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","tracks","shimRemoteStreamsAPI","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","addIceCandidate","successCallback","failureCallback","options","promise","withCallback","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","setDirection","offerToReceiveVideo","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","augmentedCandidate","toJSON","sdpMid","sdpMLineIndex","shimMaxMessageSize","_sctp","sctpInDescription","mLine","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","shimSendThrowTypeError","origCreateDataChannel","createDataChannel","dataChannel","wrapDcSend","channel","dc","origDataChannelSend","send","byteLength","readyState","shimConnectionState","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeExtmapAllowMixed","nativeSRD","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","adapter","shimChrome","shimFirefox","shimEdge","shimSafari","commonShim","chromeShim","browserShim","firefoxShim","edgeShim","safariShim","adapterFactory","bodyOpenClassName","portalClassName","_react","_react2","_interopRequireDefault","_reactDom2","_propTypes2","_ModalPortal2","ariaAppHider","newObj","_interopRequireWildcard","_safeHTMLElement2","_reactLifecyclesCompat","isReact16","createPortal","createHTMLElement","getCreatePortal","unstable_renderSubtreeIntoContainer","getParentElement","parentSelector","Modal","_Component","_temp","removePortal","unmountComponentAtNode","node","parent","contains","removeChild","portalRef","portal","renderPortal","defaultStyles","className","appendChild","prevProps","prevParent","nextParent","_","snapshot","_props","isOpen","now","Date","closesAt","closeTimeoutMS","beforeClose","closeWithTimeout","setTimeout","propTypes","isRequired","shape","content","overlay","string","htmlOpenClassName","oneOfType","afterOpen","overlayClassName","instanceOf","arrayOf","onAfterOpen","onRequestClose","number","ariaHideApp","shouldFocusAfterRender","shouldCloseOnOverlayClick","shouldReturnFocusAfterClose","preventScroll","aria","contentLabel","shouldCloseOnEsc","overlayRef","contentRef","overlayElement","contentElement","contentEl","children","position","top","left","right","bottom","backgroundColor","border","background","overflow","WebkitOverflowScrolling","borderRadius","outline","padding","polyfill","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","propName","componentName","location","propFullName","secret","getShim","ReactPropTypes","array","bigint","symbol","any","elementType","objectOf","oneOf","checkPropTypes","PropTypes","focusManager","_scopeTab2","classList","_portalOpenInstances2","CLASS_NAMES","ariaHiddenInstances","ModalPortal","setOverlayRef","setContentRef","afterClose","remove","getElementsByTagName","returnFocus","teardownScopedFocus","popWithoutFocus","onAfterClose","open","beforeOpen","clearTimeout","closeTimer","setupScopedFocus","markForFocusLater","openAnimationFrame","requestAnimationFrame","overlayEl","close","closeWithoutTimeout","focusContent","contentHasFocus","focus","handleKeyDown","keyCode","stopPropagation","requestClose","handleOverlayOnClick","shouldClose","ownerHandlesClose","handleContentOnMouseUp","handleOverlayOnMouseDown","preventDefault","handleContentOnClick","handleContentOnMouseDown","shouldBeClosed","activeElement","buildClassName","which","additional","classNames","attributesFromObject","items","acc","moveFromContentToOverlay","prevState","cancelAnimationFrame","add","_props2","contentStyles","overlayStyles","overlayProps","onClick","onMouseDown","contentProps","onKeyDown","onMouseUp","modal","testId","focusLaterElements","handleBlur","handleFocus","toFocus","pop","modalElement","attachEvent","detachEvent","_tabbable","_tabbable2","needToFocus","shiftKey","head","tail","getActiveElement","checkSafari","exec","warning","ExecutionEnvironment","canUseWorkers","Worker","canUseEventListeners","canUseViewport","screen","define","htmlElement","cls","htmlClassList","removeClass","_cls","docBodyClassList","at","classString","classListRef","poll","incrementReference","decrementReference","_arr","before","after","_i","item","instances","_arr2","_i2","check","_portalOpenInstances","opacity","cloneNode","firstChild","insertBefore","lastChild","componentWillMount","getDerivedStateFromProps","componentWillReceiveProps","componentWillUpdate","nextState","__reactInternalSnapshotFlag","__reactInternalSnapshot","getSnapshotBeforeUpdate","isReactComponent","foundWillMountName","foundWillReceivePropsName","foundWillUpdateName","UNSAFE_componentWillMount","UNSAFE_componentWillReceiveProps","UNSAFE_componentWillUpdate","displayName","newApiName","componentDidUpdate","maybeSnapshot","__suppressDeprecationWarning","BitByte","RSBlock","BitBuffer","util","Polynomial","typeNumber","errorCorrectLevel","moduleCount","dataCache","dataList","newData","isDark","col","getModuleCount","rsBlocks","getRSBlocks","buffer","totalDataCount","dataCount","put","mode","getLengthInBits","write","makeImpl","getBestMaskPattern","maskPattern","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","minLostPoint","pattern","lostPoint","getLostPoint","createMovieClip","target_mc","instance_name","depth","qr_mc","createEmptyMovieClip","beginFill","moveTo","lineTo","endFill","getPatternPosition","bits","getBCHTypeNumber","getBCHTypeInfo","inc","bitIndex","byteIndex","dark","getMask","PAD0","PAD1","putBit","createBytes","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","ecCount","totalCount","rsPoly","getErrorCorrectPolynomial","modPoly","modIndex","totalCodeCount","QR8bitByte","ECL","QRRSBlock","RS_BLOCK_TABLE","rsBlock","getRsBlockTable","list","count","QRBitBuffer","bufIndex","bit","Mode","QRMaskPattern","QRUtil","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","getBCHDigit","digit","errorCorrectLength","qrCode","sameCount","darkCount","abs","dtlsRole","_initialTrackId","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","findCodecByPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","rCodec","lHeaderExtension","rHeaderExtension","isActionAllowedInSignalingState","action","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","remoteCandidate","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","trackEvent","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceGatheringState","usingBundle","bundlePolicy","rtcpMuxPolicy","iceTransportPolicy","_iceGatherers","iceCandidatePoolSize","gatherPolicy","_config","transceivers","_sdpSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","_gather","onlocalcandidate","evt","cand","serializedCandidate","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","_disposeIceAndDtlsTransports","_transceive","recv","receive","isIceLite","rejected","remoteIceParameters","remoteDtlsParameters","_updateSignalingState","receiverList","iceOptions","remoteMsid","isComplete","cands","setTransport","setRemoteCandidates","getCapabilities","isNewTrack","nativeTrack","removeTrackFromStreamAndFireEvent","sid","newState","states","closed","connected","disconnected","failed","new","connecting","numAudioTracks","numVideoTracks","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","candidateString","senderOrReceiver","promises","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods"],"mappings":"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","file":"static/js/9.4673920e.chunk.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Modal = require(\"./components/Modal\");\n\nvar _Modal2 = _interopRequireDefault(_Modal);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _Modal2.default;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.canUseDOM = exports.SafeNodeList = exports.SafeHTMLCollection = undefined;\n\nvar _exenv = require(\"exenv\");\n\nvar _exenv2 = _interopRequireDefault(_exenv);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar EE = _exenv2.default;\n\nvar SafeHTMLElement = EE.canUseDOM ? window.HTMLElement : {};\n\nvar SafeHTMLCollection = exports.SafeHTMLCollection = EE.canUseDOM ? window.HTMLCollection : {};\n\nvar SafeNodeList = exports.SafeNodeList = EE.canUseDOM ? window.NodeList : {};\n\nvar canUseDOM = exports.canUseDOM = EE.canUseDOM;\n\nexports.default = SafeHTMLElement;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = findTabbableDescendants;\n/*!\n * Adapted from jQuery UI core\n *\n * http://jqueryui.com\n *\n * Copyright 2014 jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/category/ui-core/\n */\n\nvar tabbableNode = /input|select|textarea|button|object/;\n\nfunction hidesContents(element) {\n  var zeroSize = element.offsetWidth <= 0 && element.offsetHeight <= 0;\n\n  // If the node is empty, this is good enough\n  if (zeroSize && !element.innerHTML) return true;\n\n  try {\n    // Otherwise we need to check some styles\n    var style = window.getComputedStyle(element);\n    return zeroSize ? style.getPropertyValue(\"overflow\") !== \"visible\" ||\n    // if 'overflow: visible' set, check if there is actually any overflow\n    element.scrollWidth <= 0 && element.scrollHeight <= 0 : style.getPropertyValue(\"display\") == \"none\";\n  } catch (exception) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Failed to inspect element style\");\n    return false;\n  }\n}\n\nfunction visible(element) {\n  var parentElement = element;\n  var rootNode = element.getRootNode && element.getRootNode();\n  while (parentElement) {\n    if (parentElement === document.body) break;\n\n    // if we are not hidden yet, skip to checking outside the Web Component\n    if (rootNode && parentElement === rootNode) parentElement = rootNode.host.parentNode;\n\n    if (hidesContents(parentElement)) return false;\n    parentElement = parentElement.parentNode;\n  }\n  return true;\n}\n\nfunction focusable(element, isTabIndexNotNaN) {\n  var nodeName = element.nodeName.toLowerCase();\n  var res = tabbableNode.test(nodeName) && !element.disabled || (nodeName === \"a\" ? element.href || isTabIndexNotNaN : isTabIndexNotNaN);\n  return res && visible(element);\n}\n\nfunction tabbable(element) {\n  var tabIndex = element.getAttribute(\"tabindex\");\n  if (tabIndex === null) tabIndex = undefined;\n  var isTabIndexNaN = isNaN(tabIndex);\n  return (isTabIndexNaN || tabIndex >= 0) && focusable(element, !isTabIndexNaN);\n}\n\nfunction findTabbableDescendants(element) {\n  var descendants = [].slice.call(element.querySelectorAll(\"*\"), 0).reduce(function (finished, el) {\n    return finished.concat(!el.shadowRoot ? [el] : findTabbableDescendants(el.shadowRoot));\n  }, []);\n  return descendants.filter(tabbable);\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resetState = resetState;\nexports.log = log;\nexports.assertNodeList = assertNodeList;\nexports.setElement = setElement;\nexports.validateElement = validateElement;\nexports.hide = hide;\nexports.show = show;\nexports.documentNotReadyOrSSRTesting = documentNotReadyOrSSRTesting;\n\nvar _warning = require(\"warning\");\n\nvar _warning2 = _interopRequireDefault(_warning);\n\nvar _safeHTMLElement = require(\"./safeHTMLElement\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar globalElement = null;\n\n/* eslint-disable no-console */\n/* istanbul ignore next */\nfunction resetState() {\n  if (globalElement) {\n    if (globalElement.removeAttribute) {\n      globalElement.removeAttribute(\"aria-hidden\");\n    } else if (globalElement.length != null) {\n      globalElement.forEach(function (element) {\n        return element.removeAttribute(\"aria-hidden\");\n      });\n    } else {\n      document.querySelectorAll(globalElement).forEach(function (element) {\n        return element.removeAttribute(\"aria-hidden\");\n      });\n    }\n  }\n  globalElement = null;\n}\n\n/* istanbul ignore next */\nfunction log() {\n  if (process.env.NODE_ENV !== \"production\") {\n    var check = globalElement || {};\n    console.log(\"ariaAppHider ----------\");\n    console.log(check.nodeName, check.className, check.id);\n    console.log(\"end ariaAppHider ----------\");\n  }\n}\n/* eslint-enable no-console */\n\nfunction assertNodeList(nodeList, selector) {\n  if (!nodeList || !nodeList.length) {\n    throw new Error(\"react-modal: No elements were found for selector \" + selector + \".\");\n  }\n}\n\nfunction setElement(element) {\n  var useElement = element;\n  if (typeof useElement === \"string\" && _safeHTMLElement.canUseDOM) {\n    var el = document.querySelectorAll(useElement);\n    assertNodeList(el, useElement);\n    useElement = el;\n  }\n  globalElement = useElement || globalElement;\n  return globalElement;\n}\n\nfunction validateElement(appElement) {\n  var el = appElement || globalElement;\n  if (el) {\n    return Array.isArray(el) || el instanceof HTMLCollection || el instanceof NodeList ? el : [el];\n  } else {\n    (0, _warning2.default)(false, [\"react-modal: App element is not defined.\", \"Please use `Modal.setAppElement(el)` or set `appElement={el}`.\", \"This is needed so screen readers don't see main content\", \"when modal is opened. It is not recommended, but you can opt-out\", \"by setting `ariaHideApp={false}`.\"].join(\" \"));\n\n    return [];\n  }\n}\n\nfunction hide(appElement) {\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = validateElement(appElement)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var el = _step.value;\n\n      el.setAttribute(\"aria-hidden\", \"true\");\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n}\n\nfunction show(appElement) {\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = validateElement(appElement)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var el = _step2.value;\n\n      el.removeAttribute(\"aria-hidden\");\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n}\n\nfunction documentNotReadyOrSSRTesting() {\n  globalElement = null;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.log = log;\nexports.resetState = resetState;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Tracks portals that are open and emits events to subscribers\n\nvar PortalOpenInstances = function PortalOpenInstances() {\n  var _this = this;\n\n  _classCallCheck(this, PortalOpenInstances);\n\n  this.register = function (openInstance) {\n    if (_this.openInstances.indexOf(openInstance) !== -1) {\n      if (process.env.NODE_ENV !== \"production\") {\n        // eslint-disable-next-line no-console\n        console.warn(\"React-Modal: Cannot register modal instance that's already open\");\n      }\n      return;\n    }\n    _this.openInstances.push(openInstance);\n    _this.emit(\"register\");\n  };\n\n  this.deregister = function (openInstance) {\n    var index = _this.openInstances.indexOf(openInstance);\n    if (index === -1) {\n      if (process.env.NODE_ENV !== \"production\") {\n        // eslint-disable-next-line no-console\n        console.warn(\"React-Modal: Unable to deregister \" + openInstance + \" as \" + \"it was never registered\");\n      }\n      return;\n    }\n    _this.openInstances.splice(index, 1);\n    _this.emit(\"deregister\");\n  };\n\n  this.subscribe = function (callback) {\n    _this.subscribers.push(callback);\n  };\n\n  this.emit = function (eventType) {\n    _this.subscribers.forEach(function (subscriber) {\n      return subscriber(eventType,\n      // shallow copy to avoid accidental mutation\n      _this.openInstances.slice());\n    });\n  };\n\n  this.openInstances = [];\n  this.subscribers = [];\n};\n\nvar portalOpenInstances = new PortalOpenInstances();\n\n/* eslint-disable no-console */\n/* istanbul ignore next */\nfunction log() {\n  console.log(\"portalOpenInstances ----------\");\n  console.log(portalOpenInstances.openInstances.length);\n  portalOpenInstances.openInstances.forEach(function (p) {\n    return console.log(p);\n  });\n  console.log(\"end portalOpenInstances ----------\");\n}\n\n/* istanbul ignore next */\nfunction resetState() {\n  portalOpenInstances = new PortalOpenInstances();\n}\n/* eslint-enable no-console */\n\nexports.default = portalOpenInstances;","'use strict';\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar React = require('react');\n\nvar PropTypes = require('prop-types'); // qr.js doesn't handle error level of zero (M) so we need to do it right,\n// thus the deep require.\n\n\nvar QRCodeImpl = require('qr.js/lib/QRCode');\n\nvar ErrorCorrectLevel = require('qr.js/lib/ErrorCorrectLevel'); // TODO: pull this off of the QRCode class type so it matches.\n\n\n// Convert from UTF-16, forcing the use of byte-mode encoding in our QR Code.\n// This allows us to encode Hanji, Kanji, emoji, etc. Ideally we'd do more\n// detection and not resort to byte-mode if possible, but we're trading off\n// a smaller library for a smaller amount of data we can potentially encode.\n// Based on http://jonisalonen.com/2012/from-utf-16-to-utf-8-in-javascript/\nfunction convertStr(str) {\n  var out = '';\n\n  for (var i = 0; i < str.length; i++) {\n    var charcode = str.charCodeAt(i);\n\n    if (charcode < 0x0080) {\n      out += String.fromCharCode(charcode);\n    } else if (charcode < 0x0800) {\n      out += String.fromCharCode(0xc0 | charcode >> 6);\n      out += String.fromCharCode(0x80 | charcode & 0x3f);\n    } else if (charcode < 0xd800 || charcode >= 0xe000) {\n      out += String.fromCharCode(0xe0 | charcode >> 12);\n      out += String.fromCharCode(0x80 | charcode >> 6 & 0x3f);\n      out += String.fromCharCode(0x80 | charcode & 0x3f);\n    } else {\n      // This is a surrogate pair, so we'll reconsitute the pieces and work\n      // from that\n      i++;\n      charcode = 0x10000 + ((charcode & 0x3ff) << 10 | str.charCodeAt(i) & 0x3ff);\n      out += String.fromCharCode(0xf0 | charcode >> 18);\n      out += String.fromCharCode(0x80 | charcode >> 12 & 0x3f);\n      out += String.fromCharCode(0x80 | charcode >> 6 & 0x3f);\n      out += String.fromCharCode(0x80 | charcode & 0x3f);\n    }\n  }\n\n  return out;\n}\n\nvar DEFAULT_PROPS = {\n  size: 128,\n  level: 'L',\n  bgColor: '#FFFFFF',\n  fgColor: '#000000',\n  includeMargin: false\n};\nvar PROP_TYPES = process.env.NODE_ENV !== 'production' ? {\n  value: PropTypes.string.isRequired,\n  size: PropTypes.number,\n  level: PropTypes.oneOf(['L', 'M', 'Q', 'H']),\n  bgColor: PropTypes.string,\n  fgColor: PropTypes.string,\n  includeMargin: PropTypes.bool,\n  imageSettings: PropTypes.shape({\n    src: PropTypes.string.isRequired,\n    height: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    excavate: PropTypes.bool,\n    x: PropTypes.number,\n    y: PropTypes.number\n  })\n} : {};\nvar MARGIN_SIZE = 4; // This is *very* rough estimate of max amount of QRCode allowed to be covered.\n// It is \"wrong\" in a lot of ways (area is a terrible way to estimate, it\n// really should be number of modules covered), but if for some reason we don't\n// get an explicit height or width, I'd rather default to something than throw.\n\nvar DEFAULT_IMG_SCALE = 0.1;\n\nfunction generatePath(modules) {\n  var margin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var ops = [];\n  modules.forEach(function (row, y) {\n    var start = null;\n    row.forEach(function (cell, x) {\n      if (!cell && start !== null) {\n        // M0 0h7v1H0z injects the space with the move and drops the comma,\n        // saving a char per operation\n        ops.push(\"M\".concat(start + margin, \" \").concat(y + margin, \"h\").concat(x - start, \"v1H\").concat(start + margin, \"z\"));\n        start = null;\n        return;\n      } // end of row, clean up or skip\n\n\n      if (x === row.length - 1) {\n        if (!cell) {\n          // We would have closed the op above already so this can only mean\n          // 2+ light modules in a row.\n          return;\n        }\n\n        if (start === null) {\n          // Just a single dark module.\n          ops.push(\"M\".concat(x + margin, \",\").concat(y + margin, \" h1v1H\").concat(x + margin, \"z\"));\n        } else {\n          // Otherwise finish the current line.\n          ops.push(\"M\".concat(start + margin, \",\").concat(y + margin, \" h\").concat(x + 1 - start, \"v1H\").concat(start + margin, \"z\"));\n        }\n\n        return;\n      }\n\n      if (cell && start === null) {\n        start = x;\n      }\n    });\n  });\n  return ops.join('');\n} // We could just do this in generatePath, except that we want to support\n// non-Path2D canvas, so we need to keep it an explicit step.\n\n\nfunction excavateModules(modules, excavation) {\n  return modules.slice().map(function (row, y) {\n    if (y < excavation.y || y >= excavation.y + excavation.h) {\n      return row;\n    }\n\n    return row.map(function (cell, x) {\n      if (x < excavation.x || x >= excavation.x + excavation.w) {\n        return cell;\n      }\n\n      return false;\n    });\n  });\n}\n\nfunction getImageSettings(props, cells) {\n  var imageSettings = props.imageSettings,\n      size = props.size,\n      includeMargin = props.includeMargin;\n\n  if (imageSettings == null) {\n    return null;\n  }\n\n  var margin = includeMargin ? MARGIN_SIZE : 0;\n  var numCells = cells.length + margin * 2;\n  var defaultSize = Math.floor(size * DEFAULT_IMG_SCALE);\n  var scale = numCells / size;\n  var w = (imageSettings.width || defaultSize) * scale;\n  var h = (imageSettings.height || defaultSize) * scale;\n  var x = imageSettings.x == null ? cells.length / 2 - w / 2 : imageSettings.x * scale;\n  var y = imageSettings.y == null ? cells.length / 2 - h / 2 : imageSettings.y * scale;\n  var excavation = null;\n\n  if (imageSettings.excavate) {\n    var floorX = Math.floor(x);\n    var floorY = Math.floor(y);\n    var ceilW = Math.ceil(w + x - floorX);\n    var ceilH = Math.ceil(h + y - floorY);\n    excavation = {\n      x: floorX,\n      y: floorY,\n      w: ceilW,\n      h: ceilH\n    };\n  }\n\n  return {\n    x: x,\n    y: y,\n    h: h,\n    w: w,\n    excavation: excavation\n  };\n} // For canvas we're going to switch our drawing mode based on whether or not\n// the environment supports Path2D. We only need the constructor to be\n// supported, but Edge doesn't actually support the path (string) type\n// argument. Luckily it also doesn't support the addPath() method. We can\n// treat that as the same thing.\n\n\nvar SUPPORTS_PATH2D = function () {\n  try {\n    new Path2D().addPath(new Path2D());\n  } catch (e) {\n    return false;\n  }\n\n  return true;\n}();\n\nvar QRCodeCanvas =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(QRCodeCanvas, _React$PureComponent);\n\n  function QRCodeCanvas() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, QRCodeCanvas);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(QRCodeCanvas)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_canvas\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_image\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      imgLoaded: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleImageLoad\", function () {\n      _this.setState({\n        imgLoaded: true\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(QRCodeCanvas, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this._image && this._image.complete) {\n        this.handleImageLoad();\n      }\n\n      this.update();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var _this$props$imageSett, _nextProps$imageSetti;\n\n      var currentSrc = (_this$props$imageSett = this.props.imageSettings) === null || _this$props$imageSett === void 0 ? void 0 : _this$props$imageSett.src;\n      var nextSrc = (_nextProps$imageSetti = nextProps.imageSettings) === null || _nextProps$imageSetti === void 0 ? void 0 : _nextProps$imageSetti.src;\n\n      if (currentSrc !== nextSrc) {\n        this.setState({\n          imgLoaded: false\n        });\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.update();\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      var _this$props = this.props,\n          value = _this$props.value,\n          size = _this$props.size,\n          level = _this$props.level,\n          bgColor = _this$props.bgColor,\n          fgColor = _this$props.fgColor,\n          includeMargin = _this$props.includeMargin,\n          imageSettings = _this$props.imageSettings; // We'll use type===-1 to force QRCode to automatically pick the best type\n\n      var qrcode = new QRCodeImpl(-1, ErrorCorrectLevel[level]);\n      qrcode.addData(convertStr(value));\n      qrcode.make();\n\n      if (this._canvas != null) {\n        var canvas = this._canvas;\n        var ctx = canvas.getContext('2d');\n\n        if (!ctx) {\n          return;\n        }\n\n        var cells = qrcode.modules;\n\n        if (cells === null) {\n          return;\n        }\n\n        var margin = includeMargin ? MARGIN_SIZE : 0;\n        var numCells = cells.length + margin * 2;\n        var calculatedImageSettings = getImageSettings(this.props, cells);\n\n        if (imageSettings != null && calculatedImageSettings != null) {\n          if (calculatedImageSettings.excavation != null) {\n            cells = excavateModules(cells, calculatedImageSettings.excavation);\n          }\n        } // We're going to scale this so that the number of drawable units\n        // matches the number of cells. This avoids rounding issues, but does\n        // result in some potentially unwanted single pixel issues between\n        // blocks, only in environments that don't support Path2D.\n\n\n        var pixelRatio = window.devicePixelRatio || 1;\n        canvas.height = canvas.width = size * pixelRatio;\n        var scale = size / numCells * pixelRatio;\n        ctx.scale(scale, scale); // Draw solid background, only paint dark modules.\n\n        ctx.fillStyle = bgColor;\n        ctx.fillRect(0, 0, numCells, numCells);\n        ctx.fillStyle = fgColor;\n\n        if (SUPPORTS_PATH2D) {\n          // $FlowFixMe: Path2D c'tor doesn't support args yet.\n          ctx.fill(new Path2D(generatePath(cells, margin)));\n        } else {\n          cells.forEach(function (row, rdx) {\n            row.forEach(function (cell, cdx) {\n              if (cell) {\n                ctx.fillRect(cdx + margin, rdx + margin, 1, 1);\n              }\n            });\n          });\n        }\n\n        if (this.state.imgLoaded && this._image && calculatedImageSettings != null) {\n          ctx.drawImage(this._image, calculatedImageSettings.x + margin, calculatedImageSettings.y + margin, calculatedImageSettings.w, calculatedImageSettings.h);\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          value = _this$props2.value,\n          size = _this$props2.size,\n          level = _this$props2.level,\n          bgColor = _this$props2.bgColor,\n          fgColor = _this$props2.fgColor,\n          style = _this$props2.style,\n          includeMargin = _this$props2.includeMargin,\n          imageSettings = _this$props2.imageSettings,\n          otherProps = _objectWithoutProperties(_this$props2, [\"value\", \"size\", \"level\", \"bgColor\", \"fgColor\", \"style\", \"includeMargin\", \"imageSettings\"]);\n\n      var canvasStyle = _objectSpread({\n        height: size,\n        width: size\n      }, style);\n\n      var img = null;\n      var imgSrc = imageSettings && imageSettings.src;\n\n      if (imageSettings != null && imgSrc != null) {\n        img = React.createElement(\"img\", {\n          src: imgSrc,\n          style: {\n            display: 'none'\n          },\n          onLoad: this.handleImageLoad,\n          ref: function ref(_ref) {\n            return _this2._image = _ref;\n          }\n        });\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(\"canvas\", _extends({\n        style: canvasStyle,\n        height: size,\n        width: size,\n        ref: function ref(_ref2) {\n          return _this2._canvas = _ref2;\n        }\n      }, otherProps)), img);\n    }\n  }]);\n\n  return QRCodeCanvas;\n}(React.PureComponent);\n\n_defineProperty(QRCodeCanvas, \"defaultProps\", DEFAULT_PROPS);\n\nif (process.env.NODE_ENV !== 'production') {\n  QRCodeCanvas.propTypes = PROP_TYPES;\n}\n\nvar QRCodeSVG =\n/*#__PURE__*/\nfunction (_React$PureComponent2) {\n  _inherits(QRCodeSVG, _React$PureComponent2);\n\n  function QRCodeSVG() {\n    _classCallCheck(this, QRCodeSVG);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(QRCodeSVG).apply(this, arguments));\n  }\n\n  _createClass(QRCodeSVG, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          value = _this$props3.value,\n          size = _this$props3.size,\n          level = _this$props3.level,\n          bgColor = _this$props3.bgColor,\n          fgColor = _this$props3.fgColor,\n          includeMargin = _this$props3.includeMargin,\n          imageSettings = _this$props3.imageSettings,\n          otherProps = _objectWithoutProperties(_this$props3, [\"value\", \"size\", \"level\", \"bgColor\", \"fgColor\", \"includeMargin\", \"imageSettings\"]); // We'll use type===-1 to force QRCode to automatically pick the best type\n\n\n      var qrcode = new QRCodeImpl(-1, ErrorCorrectLevel[level]);\n      qrcode.addData(convertStr(value));\n      qrcode.make();\n      var cells = qrcode.modules;\n\n      if (cells === null) {\n        return null;\n      }\n\n      var margin = includeMargin ? MARGIN_SIZE : 0;\n      var numCells = cells.length + margin * 2;\n      var calculatedImageSettings = getImageSettings(this.props, cells);\n      var image = null;\n\n      if (imageSettings != null && calculatedImageSettings != null) {\n        if (calculatedImageSettings.excavation != null) {\n          cells = excavateModules(cells, calculatedImageSettings.excavation);\n        }\n\n        image = React.createElement(\"image\", {\n          xlinkHref: imageSettings.src,\n          height: calculatedImageSettings.h,\n          width: calculatedImageSettings.w,\n          x: calculatedImageSettings.x + margin,\n          y: calculatedImageSettings.y + margin,\n          preserveAspectRatio: \"none\"\n        });\n      } // Drawing strategy: instead of a rect per module, we're going to create a\n      // single path for the dark modules and layer that on top of a light rect,\n      // for a total of 2 DOM nodes. We pay a bit more in string concat but that's\n      // way faster than DOM ops.\n      // For level 1, 441 nodes -> 2\n      // For level 40, 31329 -> 2\n\n\n      var fgPath = generatePath(cells, margin);\n      return React.createElement(\"svg\", _extends({\n        shapeRendering: \"crispEdges\",\n        height: size,\n        width: size,\n        viewBox: \"0 0 \".concat(numCells, \" \").concat(numCells)\n      }, otherProps), React.createElement(\"path\", {\n        fill: bgColor,\n        d: \"M0,0 h\".concat(numCells, \"v\").concat(numCells, \"H0z\")\n      }), React.createElement(\"path\", {\n        fill: fgColor,\n        d: fgPath\n      }), image);\n    }\n  }]);\n\n  return QRCodeSVG;\n}(React.PureComponent);\n\n_defineProperty(QRCodeSVG, \"defaultProps\", DEFAULT_PROPS);\n\nif (process.env.NODE_ENV !== 'production') {\n  QRCodeSVG.propTypes = PROP_TYPES;\n}\n\nvar QRCode = function QRCode(props) {\n  var renderAs = props.renderAs,\n      otherProps = _objectWithoutProperties(props, [\"renderAs\"]);\n\n  var Component = renderAs === 'svg' ? QRCodeSVG : QRCodeCanvas;\n  return React.createElement(Component, otherProps);\n};\n\nQRCode.defaultProps = _objectSpread({\n  renderAs: 'canvas'\n}, DEFAULT_PROPS);\nmodule.exports = QRCode;","module.exports = {\n\tMODE_NUMBER :\t\t1 << 0,\n\tMODE_ALPHA_NUM : \t1 << 1,\n\tMODE_8BIT_BYTE : \t1 << 2,\n\tMODE_KANJI :\t\t1 << 3\n};\n","module.exports = {\n\tL : 1,\n\tM : 0,\n\tQ : 3,\n\tH : 2\n};\n\n","var math = require('./math');\n\nfunction QRPolynomial(num, shift) {\n\n\tif (num.length == undefined) {\n\t\tthrow new Error(num.length + \"/\" + shift);\n\t}\n\n\tvar offset = 0;\n\n\twhile (offset < num.length && num[offset] == 0) {\n\t\toffset++;\n\t}\n\n\tthis.num = new Array(num.length - offset + shift);\n\tfor (var i = 0; i < num.length - offset; i++) {\n\t\tthis.num[i] = num[i + offset];\n\t}\n}\n\nQRPolynomial.prototype = {\n\n\tget : function(index) {\n\t\treturn this.num[index];\n\t},\n\t\n\tgetLength : function() {\n\t\treturn this.num.length;\n\t},\n\t\n\tmultiply : function(e) {\n\t\n\t\tvar num = new Array(this.getLength() + e.getLength() - 1);\n\t\n\t\tfor (var i = 0; i < this.getLength(); i++) {\n\t\t\tfor (var j = 0; j < e.getLength(); j++) {\n\t\t\t\tnum[i + j] ^= math.gexp(math.glog(this.get(i) ) + math.glog(e.get(j) ) );\n\t\t\t}\n\t\t}\n\t\n\t\treturn new QRPolynomial(num, 0);\n\t},\n\t\n\tmod : function(e) {\n\t\n\t\tif (this.getLength() - e.getLength() < 0) {\n\t\t\treturn this;\n\t\t}\n\t\n\t\tvar ratio = math.glog(this.get(0) ) - math.glog(e.get(0) );\n\t\n\t\tvar num = new Array(this.getLength() );\n\t\t\n\t\tfor (var i = 0; i < this.getLength(); i++) {\n\t\t\tnum[i] = this.get(i);\n\t\t}\n\t\t\n\t\tfor (var i = 0; i < e.getLength(); i++) {\n\t\t\tnum[i] ^= math.gexp(math.glog(e.get(i) ) + ratio);\n\t\t}\n\t\n\t\t// recursive call\n\t\treturn new QRPolynomial(num, 0).mod(e);\n\t}\n};\n\nmodule.exports = QRPolynomial;\n","var QRMath = {\n\n\tglog : function(n) {\n\t\n\t\tif (n < 1) {\n\t\t\tthrow new Error(\"glog(\" + n + \")\");\n\t\t}\n\t\t\n\t\treturn QRMath.LOG_TABLE[n];\n\t},\n\t\n\tgexp : function(n) {\n\t\n\t\twhile (n < 0) {\n\t\t\tn += 255;\n\t\t}\n\t\n\t\twhile (n >= 256) {\n\t\t\tn -= 255;\n\t\t}\n\t\n\t\treturn QRMath.EXP_TABLE[n];\n\t},\n\t\n\tEXP_TABLE : new Array(256),\n\t\n\tLOG_TABLE : new Array(256)\n\n};\n\t\nfor (var i = 0; i < 8; i++) {\n\tQRMath.EXP_TABLE[i] = 1 << i;\n}\nfor (var i = 8; i < 256; i++) {\n\tQRMath.EXP_TABLE[i] = QRMath.EXP_TABLE[i - 4]\n\t\t^ QRMath.EXP_TABLE[i - 5]\n\t\t^ QRMath.EXP_TABLE[i - 6]\n\t\t^ QRMath.EXP_TABLE[i - 8];\n}\nfor (var i = 0; i < 255; i++) {\n\tQRMath.LOG_TABLE[QRMath.EXP_TABLE[i] ] = i;\n}\n\nmodule.exports = QRMath;\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substr(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES paramters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substr(12),\n    password: pwd.substr(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n      'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n        /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection &&\n       !window.RTCIceGatherer)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n        /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices &&\n      navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent,\n        /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n        /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(devices => {\n            devices = devices.filter(d => d.kind === 'videoinput');\n            let dev = devices.find(d => matches.some(match =>\n              d.label.toLowerCase().includes(match)));\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n      .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n          this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n          externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n          internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n      .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n      window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n      'localDescription', {\n        get() {\n          const description = origLocalDescription.get.apply(this);\n          if (description.type === '') {\n            return description;\n          }\n          return replaceInternalStreamId(this, description);\n        }\n      });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  const shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(e => Promise.reject(shimError_(e)));\n  };\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    window.navigator.getDisplayMedia.bind(window.navigator);\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nimport {filterIceServers} from './filtericeservers';\nimport shimRTCPeerConnection from 'rtcpeerconnection-shim';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function RTCSessionDescription(args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      const origMSTEnabled = Object.getOwnPropertyDescriptor(\n          window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set(value) {\n          origMSTEnabled.set.call(this, value);\n          const ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  const RTCPeerConnectionShim = shimRTCPeerConnection(window,\n      browserDetails.version);\n  window.RTCPeerConnection = function RTCPeerConnection(config) {\n    if (config && config.iceServers) {\n      config.iceServers = filterIceServers(config.iceServers,\n        browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nexport function shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender &&\n      !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack =\n        window.RTCRtpSender.prototype.setTrack;\n  }\n}\n","/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n        Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        const initParameters = arguments[1];\n        const shouldPerformCheck = initParameters &&\n                                  'sendEncodings' in initParameters;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          initParameters.sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = initParameters.sendEncodings;\n            sender.sendEncodings = initParameters.sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateOffer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateAnswer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n      .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio');\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n          parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n            this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n            this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n  // Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as edgeShim from './edge/edge_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimEdge: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window, browserDetails);\n      edgeShim.shimGetDisplayMedia(window, browserDetails);\n      edgeShim.shimPeerConnection(window, browserDetails);\n      edgeShim.shimReplaceTrack(window, browserDetails);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.bodyOpenClassName = exports.portalClassName = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _ModalPortal = require(\"./ModalPortal\");\n\nvar _ModalPortal2 = _interopRequireDefault(_ModalPortal);\n\nvar _ariaAppHider = require(\"../helpers/ariaAppHider\");\n\nvar ariaAppHider = _interopRequireWildcard(_ariaAppHider);\n\nvar _safeHTMLElement = require(\"../helpers/safeHTMLElement\");\n\nvar _safeHTMLElement2 = _interopRequireDefault(_safeHTMLElement);\n\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar portalClassName = exports.portalClassName = \"ReactModalPortal\";\nvar bodyOpenClassName = exports.bodyOpenClassName = \"ReactModal__Body--open\";\n\nvar isReact16 = _safeHTMLElement.canUseDOM && _reactDom2.default.createPortal !== undefined;\n\nvar createHTMLElement = function createHTMLElement(name) {\n  return document.createElement(name);\n};\n\nvar getCreatePortal = function getCreatePortal() {\n  return isReact16 ? _reactDom2.default.createPortal : _reactDom2.default.unstable_renderSubtreeIntoContainer;\n};\n\nfunction getParentElement(parentSelector) {\n  return parentSelector();\n}\n\nvar Modal = function (_Component) {\n  _inherits(Modal, _Component);\n\n  function Modal() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Modal);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Modal.__proto__ || Object.getPrototypeOf(Modal)).call.apply(_ref, [this].concat(args))), _this), _this.removePortal = function () {\n      !isReact16 && _reactDom2.default.unmountComponentAtNode(_this.node);\n      var parent = getParentElement(_this.props.parentSelector);\n      if (parent && parent.contains(_this.node)) {\n        parent.removeChild(_this.node);\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn('React-Modal: \"parentSelector\" prop did not returned any DOM ' + \"element. Make sure that the parent element is unmounted to \" + \"avoid any memory leaks.\");\n      }\n    }, _this.portalRef = function (ref) {\n      _this.portal = ref;\n    }, _this.renderPortal = function (props) {\n      var createPortal = getCreatePortal();\n      var portal = createPortal(_this, _react2.default.createElement(_ModalPortal2.default, _extends({ defaultStyles: Modal.defaultStyles }, props)), _this.node);\n      _this.portalRef(portal);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Modal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (!_safeHTMLElement.canUseDOM) return;\n\n      if (!isReact16) {\n        this.node = createHTMLElement(\"div\");\n      }\n      this.node.className = this.props.portalClassName;\n\n      var parent = getParentElement(this.props.parentSelector);\n      parent.appendChild(this.node);\n\n      !isReact16 && this.renderPortal(this.props);\n    }\n  }, {\n    key: \"getSnapshotBeforeUpdate\",\n    value: function getSnapshotBeforeUpdate(prevProps) {\n      var prevParent = getParentElement(prevProps.parentSelector);\n      var nextParent = getParentElement(this.props.parentSelector);\n      return { prevParent: prevParent, nextParent: nextParent };\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, _, snapshot) {\n      if (!_safeHTMLElement.canUseDOM) return;\n      var _props = this.props,\n          isOpen = _props.isOpen,\n          portalClassName = _props.portalClassName;\n\n\n      if (prevProps.portalClassName !== portalClassName) {\n        this.node.className = portalClassName;\n      }\n\n      var prevParent = snapshot.prevParent,\n          nextParent = snapshot.nextParent;\n\n      if (nextParent !== prevParent) {\n        prevParent.removeChild(this.node);\n        nextParent.appendChild(this.node);\n      }\n\n      // Stop unnecessary renders if modal is remaining closed\n      if (!prevProps.isOpen && !isOpen) return;\n\n      !isReact16 && this.renderPortal(this.props);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (!_safeHTMLElement.canUseDOM || !this.node || !this.portal) return;\n\n      var state = this.portal.state;\n      var now = Date.now();\n      var closesAt = state.isOpen && this.props.closeTimeoutMS && (state.closesAt || now + this.props.closeTimeoutMS);\n\n      if (closesAt) {\n        if (!state.beforeClose) {\n          this.portal.closeWithTimeout();\n        }\n\n        setTimeout(this.removePortal, closesAt - now);\n      } else {\n        this.removePortal();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!_safeHTMLElement.canUseDOM || !isReact16) {\n        return null;\n      }\n\n      if (!this.node && isReact16) {\n        this.node = createHTMLElement(\"div\");\n      }\n\n      var createPortal = getCreatePortal();\n      return createPortal(_react2.default.createElement(_ModalPortal2.default, _extends({\n        ref: this.portalRef,\n        defaultStyles: Modal.defaultStyles\n      }, this.props)), this.node);\n    }\n  }], [{\n    key: \"setAppElement\",\n    value: function setAppElement(element) {\n      ariaAppHider.setElement(element);\n    }\n\n    /* eslint-disable react/no-unused-prop-types */\n\n    /* eslint-enable react/no-unused-prop-types */\n\n  }]);\n\n  return Modal;\n}(_react.Component);\n\nModal.propTypes = {\n  isOpen: _propTypes2.default.bool.isRequired,\n  style: _propTypes2.default.shape({\n    content: _propTypes2.default.object,\n    overlay: _propTypes2.default.object\n  }),\n  portalClassName: _propTypes2.default.string,\n  bodyOpenClassName: _propTypes2.default.string,\n  htmlOpenClassName: _propTypes2.default.string,\n  className: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.shape({\n    base: _propTypes2.default.string.isRequired,\n    afterOpen: _propTypes2.default.string.isRequired,\n    beforeClose: _propTypes2.default.string.isRequired\n  })]),\n  overlayClassName: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.shape({\n    base: _propTypes2.default.string.isRequired,\n    afterOpen: _propTypes2.default.string.isRequired,\n    beforeClose: _propTypes2.default.string.isRequired\n  })]),\n  appElement: _propTypes2.default.oneOfType([_propTypes2.default.instanceOf(_safeHTMLElement2.default), _propTypes2.default.instanceOf(_safeHTMLElement.SafeHTMLCollection), _propTypes2.default.instanceOf(_safeHTMLElement.SafeNodeList), _propTypes2.default.arrayOf(_propTypes2.default.instanceOf(_safeHTMLElement2.default))]),\n  onAfterOpen: _propTypes2.default.func,\n  onRequestClose: _propTypes2.default.func,\n  closeTimeoutMS: _propTypes2.default.number,\n  ariaHideApp: _propTypes2.default.bool,\n  shouldFocusAfterRender: _propTypes2.default.bool,\n  shouldCloseOnOverlayClick: _propTypes2.default.bool,\n  shouldReturnFocusAfterClose: _propTypes2.default.bool,\n  preventScroll: _propTypes2.default.bool,\n  parentSelector: _propTypes2.default.func,\n  aria: _propTypes2.default.object,\n  data: _propTypes2.default.object,\n  role: _propTypes2.default.string,\n  contentLabel: _propTypes2.default.string,\n  shouldCloseOnEsc: _propTypes2.default.bool,\n  overlayRef: _propTypes2.default.func,\n  contentRef: _propTypes2.default.func,\n  id: _propTypes2.default.string,\n  overlayElement: _propTypes2.default.func,\n  contentElement: _propTypes2.default.func\n};\nModal.defaultProps = {\n  isOpen: false,\n  portalClassName: portalClassName,\n  bodyOpenClassName: bodyOpenClassName,\n  role: \"dialog\",\n  ariaHideApp: true,\n  closeTimeoutMS: 0,\n  shouldFocusAfterRender: true,\n  shouldCloseOnEsc: true,\n  shouldCloseOnOverlayClick: true,\n  shouldReturnFocusAfterClose: true,\n  preventScroll: false,\n  parentSelector: function parentSelector() {\n    return document.body;\n  },\n  overlayElement: function overlayElement(props, contentEl) {\n    return _react2.default.createElement(\n      \"div\",\n      props,\n      contentEl\n    );\n  },\n  contentElement: function contentElement(props, children) {\n    return _react2.default.createElement(\n      \"div\",\n      props,\n      children\n    );\n  }\n};\nModal.defaultStyles = {\n  overlay: {\n    position: \"fixed\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: \"rgba(255, 255, 255, 0.75)\"\n  },\n  content: {\n    position: \"absolute\",\n    top: \"40px\",\n    left: \"40px\",\n    right: \"40px\",\n    bottom: \"40px\",\n    border: \"1px solid #ccc\",\n    background: \"#fff\",\n    overflow: \"auto\",\n    WebkitOverflowScrolling: \"touch\",\n    borderRadius: \"4px\",\n    outline: \"none\",\n    padding: \"20px\"\n  }\n};\n\n\n(0, _reactLifecyclesCompat.polyfill)(Modal);\n\nif (process.env.NODE_ENV !== \"production\") {\n  Modal.setCreateHTMLElement = function (fn) {\n    return createHTMLElement = fn;\n  };\n}\n\nexports.default = Modal;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _focusManager = require(\"../helpers/focusManager\");\n\nvar focusManager = _interopRequireWildcard(_focusManager);\n\nvar _scopeTab = require(\"../helpers/scopeTab\");\n\nvar _scopeTab2 = _interopRequireDefault(_scopeTab);\n\nvar _ariaAppHider = require(\"../helpers/ariaAppHider\");\n\nvar ariaAppHider = _interopRequireWildcard(_ariaAppHider);\n\nvar _classList = require(\"../helpers/classList\");\n\nvar classList = _interopRequireWildcard(_classList);\n\nvar _safeHTMLElement = require(\"../helpers/safeHTMLElement\");\n\nvar _safeHTMLElement2 = _interopRequireDefault(_safeHTMLElement);\n\nvar _portalOpenInstances = require(\"../helpers/portalOpenInstances\");\n\nvar _portalOpenInstances2 = _interopRequireDefault(_portalOpenInstances);\n\nrequire(\"../helpers/bodyTrap\");\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// so that our CSS is statically analyzable\nvar CLASS_NAMES = {\n  overlay: \"ReactModal__Overlay\",\n  content: \"ReactModal__Content\"\n};\n\nvar TAB_KEY = 9;\nvar ESC_KEY = 27;\n\nvar ariaHiddenInstances = 0;\n\nvar ModalPortal = function (_Component) {\n  _inherits(ModalPortal, _Component);\n\n  function ModalPortal(props) {\n    _classCallCheck(this, ModalPortal);\n\n    var _this = _possibleConstructorReturn(this, (ModalPortal.__proto__ || Object.getPrototypeOf(ModalPortal)).call(this, props));\n\n    _this.setOverlayRef = function (overlay) {\n      _this.overlay = overlay;\n      _this.props.overlayRef && _this.props.overlayRef(overlay);\n    };\n\n    _this.setContentRef = function (content) {\n      _this.content = content;\n      _this.props.contentRef && _this.props.contentRef(content);\n    };\n\n    _this.afterClose = function () {\n      var _this$props = _this.props,\n          appElement = _this$props.appElement,\n          ariaHideApp = _this$props.ariaHideApp,\n          htmlOpenClassName = _this$props.htmlOpenClassName,\n          bodyOpenClassName = _this$props.bodyOpenClassName;\n\n      // Remove classes.\n\n      bodyOpenClassName && classList.remove(document.body, bodyOpenClassName);\n\n      htmlOpenClassName && classList.remove(document.getElementsByTagName(\"html\")[0], htmlOpenClassName);\n\n      // Reset aria-hidden attribute if all modals have been removed\n      if (ariaHideApp && ariaHiddenInstances > 0) {\n        ariaHiddenInstances -= 1;\n\n        if (ariaHiddenInstances === 0) {\n          ariaAppHider.show(appElement);\n        }\n      }\n\n      if (_this.props.shouldFocusAfterRender) {\n        if (_this.props.shouldReturnFocusAfterClose) {\n          focusManager.returnFocus(_this.props.preventScroll);\n          focusManager.teardownScopedFocus();\n        } else {\n          focusManager.popWithoutFocus();\n        }\n      }\n\n      if (_this.props.onAfterClose) {\n        _this.props.onAfterClose();\n      }\n\n      _portalOpenInstances2.default.deregister(_this);\n    };\n\n    _this.open = function () {\n      _this.beforeOpen();\n      if (_this.state.afterOpen && _this.state.beforeClose) {\n        clearTimeout(_this.closeTimer);\n        _this.setState({ beforeClose: false });\n      } else {\n        if (_this.props.shouldFocusAfterRender) {\n          focusManager.setupScopedFocus(_this.node);\n          focusManager.markForFocusLater();\n        }\n\n        _this.setState({ isOpen: true }, function () {\n          _this.openAnimationFrame = requestAnimationFrame(function () {\n            _this.setState({ afterOpen: true });\n\n            if (_this.props.isOpen && _this.props.onAfterOpen) {\n              _this.props.onAfterOpen({\n                overlayEl: _this.overlay,\n                contentEl: _this.content\n              });\n            }\n          });\n        });\n      }\n    };\n\n    _this.close = function () {\n      if (_this.props.closeTimeoutMS > 0) {\n        _this.closeWithTimeout();\n      } else {\n        _this.closeWithoutTimeout();\n      }\n    };\n\n    _this.focusContent = function () {\n      return _this.content && !_this.contentHasFocus() && _this.content.focus({ preventScroll: true });\n    };\n\n    _this.closeWithTimeout = function () {\n      var closesAt = Date.now() + _this.props.closeTimeoutMS;\n      _this.setState({ beforeClose: true, closesAt: closesAt }, function () {\n        _this.closeTimer = setTimeout(_this.closeWithoutTimeout, _this.state.closesAt - Date.now());\n      });\n    };\n\n    _this.closeWithoutTimeout = function () {\n      _this.setState({\n        beforeClose: false,\n        isOpen: false,\n        afterOpen: false,\n        closesAt: null\n      }, _this.afterClose);\n    };\n\n    _this.handleKeyDown = function (event) {\n      if (event.keyCode === TAB_KEY) {\n        (0, _scopeTab2.default)(_this.content, event);\n      }\n\n      if (_this.props.shouldCloseOnEsc && event.keyCode === ESC_KEY) {\n        event.stopPropagation();\n        _this.requestClose(event);\n      }\n    };\n\n    _this.handleOverlayOnClick = function (event) {\n      if (_this.shouldClose === null) {\n        _this.shouldClose = true;\n      }\n\n      if (_this.shouldClose && _this.props.shouldCloseOnOverlayClick) {\n        if (_this.ownerHandlesClose()) {\n          _this.requestClose(event);\n        } else {\n          _this.focusContent();\n        }\n      }\n      _this.shouldClose = null;\n    };\n\n    _this.handleContentOnMouseUp = function () {\n      _this.shouldClose = false;\n    };\n\n    _this.handleOverlayOnMouseDown = function (event) {\n      if (!_this.props.shouldCloseOnOverlayClick && event.target == _this.overlay) {\n        event.preventDefault();\n      }\n    };\n\n    _this.handleContentOnClick = function () {\n      _this.shouldClose = false;\n    };\n\n    _this.handleContentOnMouseDown = function () {\n      _this.shouldClose = false;\n    };\n\n    _this.requestClose = function (event) {\n      return _this.ownerHandlesClose() && _this.props.onRequestClose(event);\n    };\n\n    _this.ownerHandlesClose = function () {\n      return _this.props.onRequestClose;\n    };\n\n    _this.shouldBeClosed = function () {\n      return !_this.state.isOpen && !_this.state.beforeClose;\n    };\n\n    _this.contentHasFocus = function () {\n      return document.activeElement === _this.content || _this.content.contains(document.activeElement);\n    };\n\n    _this.buildClassName = function (which, additional) {\n      var classNames = (typeof additional === \"undefined\" ? \"undefined\" : _typeof(additional)) === \"object\" ? additional : {\n        base: CLASS_NAMES[which],\n        afterOpen: CLASS_NAMES[which] + \"--after-open\",\n        beforeClose: CLASS_NAMES[which] + \"--before-close\"\n      };\n      var className = classNames.base;\n      if (_this.state.afterOpen) {\n        className = className + \" \" + classNames.afterOpen;\n      }\n      if (_this.state.beforeClose) {\n        className = className + \" \" + classNames.beforeClose;\n      }\n      return typeof additional === \"string\" && additional ? className + \" \" + additional : className;\n    };\n\n    _this.attributesFromObject = function (prefix, items) {\n      return Object.keys(items).reduce(function (acc, name) {\n        acc[prefix + \"-\" + name] = items[name];\n        return acc;\n      }, {});\n    };\n\n    _this.state = {\n      afterOpen: false,\n      beforeClose: false\n    };\n\n    _this.shouldClose = null;\n    _this.moveFromContentToOverlay = null;\n    return _this;\n  }\n\n  _createClass(ModalPortal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.isOpen) {\n        this.open();\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (process.env.NODE_ENV !== \"production\") {\n        if (prevProps.bodyOpenClassName !== this.props.bodyOpenClassName) {\n          // eslint-disable-next-line no-console\n          console.warn('React-Modal: \"bodyOpenClassName\" prop has been modified. ' + \"This may cause unexpected behavior when multiple modals are open.\");\n        }\n        if (prevProps.htmlOpenClassName !== this.props.htmlOpenClassName) {\n          // eslint-disable-next-line no-console\n          console.warn('React-Modal: \"htmlOpenClassName\" prop has been modified. ' + \"This may cause unexpected behavior when multiple modals are open.\");\n        }\n      }\n\n      if (this.props.isOpen && !prevProps.isOpen) {\n        this.open();\n      } else if (!this.props.isOpen && prevProps.isOpen) {\n        this.close();\n      }\n\n      // Focus only needs to be set once when the modal is being opened\n      if (this.props.shouldFocusAfterRender && this.state.isOpen && !prevState.isOpen) {\n        this.focusContent();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.state.isOpen) {\n        this.afterClose();\n      }\n      clearTimeout(this.closeTimer);\n      cancelAnimationFrame(this.openAnimationFrame);\n    }\n  }, {\n    key: \"beforeOpen\",\n    value: function beforeOpen() {\n      var _props = this.props,\n          appElement = _props.appElement,\n          ariaHideApp = _props.ariaHideApp,\n          htmlOpenClassName = _props.htmlOpenClassName,\n          bodyOpenClassName = _props.bodyOpenClassName;\n\n      // Add classes.\n\n      bodyOpenClassName && classList.add(document.body, bodyOpenClassName);\n\n      htmlOpenClassName && classList.add(document.getElementsByTagName(\"html\")[0], htmlOpenClassName);\n\n      if (ariaHideApp) {\n        ariaHiddenInstances += 1;\n        ariaAppHider.hide(appElement);\n      }\n\n      _portalOpenInstances2.default.register(this);\n    }\n\n    // Don't steal focus from inner elements\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props2 = this.props,\n          id = _props2.id,\n          className = _props2.className,\n          overlayClassName = _props2.overlayClassName,\n          defaultStyles = _props2.defaultStyles,\n          children = _props2.children;\n\n      var contentStyles = className ? {} : defaultStyles.content;\n      var overlayStyles = overlayClassName ? {} : defaultStyles.overlay;\n\n      if (this.shouldBeClosed()) {\n        return null;\n      }\n\n      var overlayProps = {\n        ref: this.setOverlayRef,\n        className: this.buildClassName(\"overlay\", overlayClassName),\n        style: _extends({}, overlayStyles, this.props.style.overlay),\n        onClick: this.handleOverlayOnClick,\n        onMouseDown: this.handleOverlayOnMouseDown\n      };\n\n      var contentProps = _extends({\n        id: id,\n        ref: this.setContentRef,\n        style: _extends({}, contentStyles, this.props.style.content),\n        className: this.buildClassName(\"content\", className),\n        tabIndex: \"-1\",\n        onKeyDown: this.handleKeyDown,\n        onMouseDown: this.handleContentOnMouseDown,\n        onMouseUp: this.handleContentOnMouseUp,\n        onClick: this.handleContentOnClick,\n        role: this.props.role,\n        \"aria-label\": this.props.contentLabel\n      }, this.attributesFromObject(\"aria\", _extends({ modal: true }, this.props.aria)), this.attributesFromObject(\"data\", this.props.data || {}), {\n        \"data-testid\": this.props.testId\n      });\n\n      var contentElement = this.props.contentElement(contentProps, children);\n      return this.props.overlayElement(overlayProps, contentElement);\n    }\n  }]);\n\n  return ModalPortal;\n}(_react.Component);\n\nModalPortal.defaultProps = {\n  style: {\n    overlay: {},\n    content: {}\n  },\n  defaultStyles: {}\n};\nModalPortal.propTypes = {\n  isOpen: _propTypes2.default.bool.isRequired,\n  defaultStyles: _propTypes2.default.shape({\n    content: _propTypes2.default.object,\n    overlay: _propTypes2.default.object\n  }),\n  style: _propTypes2.default.shape({\n    content: _propTypes2.default.object,\n    overlay: _propTypes2.default.object\n  }),\n  className: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.object]),\n  overlayClassName: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.object]),\n  bodyOpenClassName: _propTypes2.default.string,\n  htmlOpenClassName: _propTypes2.default.string,\n  ariaHideApp: _propTypes2.default.bool,\n  appElement: _propTypes2.default.oneOfType([_propTypes2.default.instanceOf(_safeHTMLElement2.default), _propTypes2.default.instanceOf(_safeHTMLElement.SafeHTMLCollection), _propTypes2.default.instanceOf(_safeHTMLElement.SafeNodeList), _propTypes2.default.arrayOf(_propTypes2.default.instanceOf(_safeHTMLElement2.default))]),\n  onAfterOpen: _propTypes2.default.func,\n  onAfterClose: _propTypes2.default.func,\n  onRequestClose: _propTypes2.default.func,\n  closeTimeoutMS: _propTypes2.default.number,\n  shouldFocusAfterRender: _propTypes2.default.bool,\n  shouldCloseOnOverlayClick: _propTypes2.default.bool,\n  shouldReturnFocusAfterClose: _propTypes2.default.bool,\n  preventScroll: _propTypes2.default.bool,\n  role: _propTypes2.default.string,\n  contentLabel: _propTypes2.default.string,\n  aria: _propTypes2.default.object,\n  data: _propTypes2.default.object,\n  children: _propTypes2.default.node,\n  shouldCloseOnEsc: _propTypes2.default.bool,\n  overlayRef: _propTypes2.default.func,\n  contentRef: _propTypes2.default.func,\n  id: _propTypes2.default.string,\n  overlayElement: _propTypes2.default.func,\n  contentElement: _propTypes2.default.func,\n  testId: _propTypes2.default.string\n};\nexports.default = ModalPortal;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resetState = resetState;\nexports.log = log;\nexports.handleBlur = handleBlur;\nexports.handleFocus = handleFocus;\nexports.markForFocusLater = markForFocusLater;\nexports.returnFocus = returnFocus;\nexports.popWithoutFocus = popWithoutFocus;\nexports.setupScopedFocus = setupScopedFocus;\nexports.teardownScopedFocus = teardownScopedFocus;\n\nvar _tabbable = require(\"../helpers/tabbable\");\n\nvar _tabbable2 = _interopRequireDefault(_tabbable);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar focusLaterElements = [];\nvar modalElement = null;\nvar needToFocus = false;\n\n/* eslint-disable no-console */\n/* istanbul ignore next */\nfunction resetState() {\n  focusLaterElements = [];\n}\n\n/* istanbul ignore next */\nfunction log() {\n  if (process.env.NODE_ENV !== \"production\") {\n    console.log(\"focusManager ----------\");\n    focusLaterElements.forEach(function (f) {\n      var check = f || {};\n      console.log(check.nodeName, check.className, check.id);\n    });\n    console.log(\"end focusManager ----------\");\n  }\n}\n/* eslint-enable no-console */\n\nfunction handleBlur() {\n  needToFocus = true;\n}\n\nfunction handleFocus() {\n  if (needToFocus) {\n    needToFocus = false;\n    if (!modalElement) {\n      return;\n    }\n    // need to see how jQuery shims document.on('focusin') so we don't need the\n    // setTimeout, firefox doesn't support focusin, if it did, we could focus\n    // the element outside of a setTimeout. Side-effect of this implementation\n    // is that the document.body gets focus, and then we focus our element right\n    // after, seems fine.\n    setTimeout(function () {\n      if (modalElement.contains(document.activeElement)) {\n        return;\n      }\n      var el = (0, _tabbable2.default)(modalElement)[0] || modalElement;\n      el.focus();\n    }, 0);\n  }\n}\n\nfunction markForFocusLater() {\n  focusLaterElements.push(document.activeElement);\n}\n\n/* eslint-disable no-console */\nfunction returnFocus() {\n  var preventScroll = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n  var toFocus = null;\n  try {\n    if (focusLaterElements.length !== 0) {\n      toFocus = focusLaterElements.pop();\n      toFocus.focus({ preventScroll: preventScroll });\n    }\n    return;\n  } catch (e) {\n    console.warn([\"You tried to return focus to\", toFocus, \"but it is not in the DOM anymore\"].join(\" \"));\n  }\n}\n/* eslint-enable no-console */\n\nfunction popWithoutFocus() {\n  focusLaterElements.length > 0 && focusLaterElements.pop();\n}\n\nfunction setupScopedFocus(element) {\n  modalElement = element;\n\n  if (window.addEventListener) {\n    window.addEventListener(\"blur\", handleBlur, false);\n    document.addEventListener(\"focus\", handleFocus, true);\n  } else {\n    window.attachEvent(\"onBlur\", handleBlur);\n    document.attachEvent(\"onFocus\", handleFocus);\n  }\n}\n\nfunction teardownScopedFocus() {\n  modalElement = null;\n\n  if (window.addEventListener) {\n    window.removeEventListener(\"blur\", handleBlur);\n    document.removeEventListener(\"focus\", handleFocus);\n  } else {\n    window.detachEvent(\"onBlur\", handleBlur);\n    document.detachEvent(\"onFocus\", handleFocus);\n  }\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = scopeTab;\n\nvar _tabbable = require(\"./tabbable\");\n\nvar _tabbable2 = _interopRequireDefault(_tabbable);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getActiveElement() {\n  var el = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n\n  return el.activeElement.shadowRoot ? getActiveElement(el.activeElement.shadowRoot) : el.activeElement;\n}\n\nfunction scopeTab(node, event) {\n  var tabbable = (0, _tabbable2.default)(node);\n\n  if (!tabbable.length) {\n    // Do nothing, since there are no elements that can receive focus.\n    event.preventDefault();\n    return;\n  }\n\n  var target = void 0;\n\n  var shiftKey = event.shiftKey;\n  var head = tabbable[0];\n  var tail = tabbable[tabbable.length - 1];\n  var activeElement = getActiveElement();\n\n  // proceed with default browser behavior on tab.\n  // Focus on last element on shift + tab.\n  if (node === activeElement) {\n    if (!shiftKey) return;\n    target = tail;\n  }\n\n  if (tail === activeElement && !shiftKey) {\n    target = head;\n  }\n\n  if (head === activeElement && shiftKey) {\n    target = tail;\n  }\n\n  if (target) {\n    event.preventDefault();\n    target.focus();\n    return;\n  }\n\n  // Safari radio issue.\n  //\n  // Safari does not move the focus to the radio button,\n  // so we need to force it to really walk through all elements.\n  //\n  // This is very error prone, since we are trying to guess\n  // if it is a safari browser from the first occurence between\n  // chrome or safari.\n  //\n  // The chrome user agent contains the first ocurrence\n  // as the 'chrome/version' and later the 'safari/version'.\n  var checkSafari = /(\\bChrome\\b|\\bSafari\\b)\\//.exec(navigator.userAgent);\n  var isSafariDesktop = checkSafari != null && checkSafari[1] != \"Chrome\" && /\\biPod\\b|\\biPad\\b/g.exec(navigator.userAgent) == null;\n\n  // If we are not in safari desktop, let the browser control\n  // the focus\n  if (!isSafariDesktop) return;\n\n  var x = tabbable.indexOf(activeElement);\n\n  if (x > -1) {\n    x += shiftKey ? -1 : 1;\n  }\n\n  target = tabbable[x];\n\n  // If the tabbable element does not exist,\n  // focus head/tail based on shiftKey\n  if (typeof target === \"undefined\") {\n    event.preventDefault();\n    target = shiftKey ? tail : head;\n    target.focus();\n    return;\n  }\n\n  event.preventDefault();\n\n  target.focus();\n}\nmodule.exports = exports[\"default\"];","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar __DEV__ = process.env.NODE_ENV !== 'production';\n\nvar warning = function() {};\n\nif (__DEV__) {\n  var printWarning = function printWarning(format, args) {\n    var len = arguments.length;\n    args = new Array(len > 1 ? len - 1 : 0);\n    for (var key = 1; key < len; key++) {\n      args[key - 1] = arguments[key];\n    }\n    var argIndex = 0;\n    var message = 'Warning: ' +\n      format.replace(/%s/g, function() {\n        return args[argIndex++];\n      });\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  }\n\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n          '`warning(condition, format, ...args)` requires a warning ' +\n          'message argument'\n      );\n    }\n    if (!condition) {\n      printWarning.apply(null, [format].concat(args));\n    }\n  };\n}\n\nmodule.exports = warning;\n","/*!\n  Copyright (c) 2015 Jed Watson.\n  Based on code that is Copyright 2013-2015, Facebook, Inc.\n  All rights reserved.\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar canUseDOM = !!(\n\t\ttypeof window !== 'undefined' &&\n\t\twindow.document &&\n\t\twindow.document.createElement\n\t);\n\n\tvar ExecutionEnvironment = {\n\n\t\tcanUseDOM: canUseDOM,\n\n\t\tcanUseWorkers: typeof Worker !== 'undefined',\n\n\t\tcanUseEventListeners:\n\t\t\tcanUseDOM && !!(window.addEventListener || window.attachEvent),\n\n\t\tcanUseViewport: canUseDOM && !!window.screen\n\n\t};\n\n\tif (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn ExecutionEnvironment;\n\t\t});\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = ExecutionEnvironment;\n\t} else {\n\t\twindow.ExecutionEnvironment = ExecutionEnvironment;\n\t}\n\n}());\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resetState = resetState;\nexports.log = log;\nvar htmlClassList = {};\nvar docBodyClassList = {};\n\n/* eslint-disable no-console */\n/* istanbul ignore next */\nfunction removeClass(at, cls) {\n  at.classList.remove(cls);\n}\n\n/* istanbul ignore next */\nfunction resetState() {\n  var htmlElement = document.getElementsByTagName(\"html\")[0];\n  for (var cls in htmlClassList) {\n    removeClass(htmlElement, htmlClassList[cls]);\n  }\n\n  var body = document.body;\n  for (var _cls in docBodyClassList) {\n    removeClass(body, docBodyClassList[_cls]);\n  }\n\n  htmlClassList = {};\n  docBodyClassList = {};\n}\n\n/* istanbul ignore next */\nfunction log() {\n  if (process.env.NODE_ENV !== \"production\") {\n    var classes = document.getElementsByTagName(\"html\")[0].className;\n    var buffer = \"Show tracked classes:\\n\\n\";\n\n    buffer += \"<html /> (\" + classes + \"):\\n  \";\n    for (var x in htmlClassList) {\n      buffer += \"  \" + x + \" \" + htmlClassList[x] + \"\\n  \";\n    }\n\n    classes = document.body.className;\n\n    buffer += \"\\n\\ndoc.body (\" + classes + \"):\\n  \";\n    for (var _x in docBodyClassList) {\n      buffer += \"  \" + _x + \" \" + docBodyClassList[_x] + \"\\n  \";\n    }\n\n    buffer += \"\\n\";\n\n    console.log(buffer);\n  }\n}\n/* eslint-enable no-console */\n\n/**\n * Track the number of reference of a class.\n * @param {object} poll The poll to receive the reference.\n * @param {string} className The class name.\n * @return {string}\n */\nvar incrementReference = function incrementReference(poll, className) {\n  if (!poll[className]) {\n    poll[className] = 0;\n  }\n  poll[className] += 1;\n  return className;\n};\n\n/**\n * Drop the reference of a class.\n * @param {object} poll The poll to receive the reference.\n * @param {string} className The class name.\n * @return {string}\n */\nvar decrementReference = function decrementReference(poll, className) {\n  if (poll[className]) {\n    poll[className] -= 1;\n  }\n  return className;\n};\n\n/**\n * Track a class and add to the given class list.\n * @param {Object} classListRef A class list of an element.\n * @param {Object} poll         The poll to be used.\n * @param {Array}  classes      The list of classes to be tracked.\n */\nvar trackClass = function trackClass(classListRef, poll, classes) {\n  classes.forEach(function (className) {\n    incrementReference(poll, className);\n    classListRef.add(className);\n  });\n};\n\n/**\n * Untrack a class and remove from the given class list if the reference\n * reaches 0.\n * @param {Object} classListRef A class list of an element.\n * @param {Object} poll         The poll to be used.\n * @param {Array}  classes      The list of classes to be untracked.\n */\nvar untrackClass = function untrackClass(classListRef, poll, classes) {\n  classes.forEach(function (className) {\n    decrementReference(poll, className);\n    poll[className] === 0 && classListRef.remove(className);\n  });\n};\n\n/**\n * Public inferface to add classes to the document.body.\n * @param {string} bodyClass The class string to be added.\n *                           It may contain more then one class\n *                           with ' ' as separator.\n */\nvar add = exports.add = function add(element, classString) {\n  return trackClass(element.classList, element.nodeName.toLowerCase() == \"html\" ? htmlClassList : docBodyClassList, classString.split(\" \"));\n};\n\n/**\n * Public inferface to remove classes from the document.body.\n * @param {string} bodyClass The class string to be added.\n *                           It may contain more then one class\n *                           with ' ' as separator.\n */\nvar remove = exports.remove = function remove(element, classString) {\n  return untrackClass(element.classList, element.nodeName.toLowerCase() == \"html\" ? htmlClassList : docBodyClassList, classString.split(\" \"));\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resetState = resetState;\nexports.log = log;\n\nvar _portalOpenInstances = require(\"./portalOpenInstances\");\n\nvar _portalOpenInstances2 = _interopRequireDefault(_portalOpenInstances);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Body focus trap see Issue #742\n\nvar before = void 0,\n    after = void 0,\n    instances = [];\n\n/* eslint-disable no-console */\n/* istanbul ignore next */\nfunction resetState() {\n  var _arr = [before, after];\n\n  for (var _i = 0; _i < _arr.length; _i++) {\n    var item = _arr[_i];\n    if (!item) continue;\n    item.parentNode && item.parentNode.removeChild(item);\n  }\n  before = after = null;\n  instances = [];\n}\n\n/* istanbul ignore next */\nfunction log() {\n  console.log(\"bodyTrap ----------\");\n  console.log(instances.length);\n  var _arr2 = [before, after];\n  for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n    var item = _arr2[_i2];\n    var check = item || {};\n    console.log(check.nodeName, check.className, check.id);\n  }\n  console.log(\"edn bodyTrap ----------\");\n}\n/* eslint-enable no-console */\n\nfunction focusContent() {\n  if (instances.length === 0) {\n    if (process.env.NODE_ENV !== \"production\") {\n      // eslint-disable-next-line no-console\n      console.warn(\"React-Modal: Open instances > 0 expected\");\n    }\n    return;\n  }\n  instances[instances.length - 1].focusContent();\n}\n\nfunction bodyTrap(eventType, openInstances) {\n  if (!before && !after) {\n    before = document.createElement(\"div\");\n    before.setAttribute(\"data-react-modal-body-trap\", \"\");\n    before.style.position = \"absolute\";\n    before.style.opacity = \"0\";\n    before.setAttribute(\"tabindex\", \"0\");\n    before.addEventListener(\"focus\", focusContent);\n    after = before.cloneNode();\n    after.addEventListener(\"focus\", focusContent);\n  }\n\n  instances = openInstances;\n\n  if (instances.length > 0) {\n    // Add focus trap\n    if (document.body.firstChild !== before) {\n      document.body.insertBefore(before, document.body.firstChild);\n    }\n    if (document.body.lastChild !== after) {\n      document.body.appendChild(after);\n    }\n  } else {\n    // Remove focus trap\n    if (before.parentElement) {\n      before.parentElement.removeChild(before);\n    }\n    if (after.parentElement) {\n      after.parentElement.removeChild(after);\n    }\n  }\n}\n\n_portalOpenInstances2.default.subscribe(bodyTrap);","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction componentWillMount() {\n  // Call this.constructor.gDSFP to support sub-classes.\n  var state = this.constructor.getDerivedStateFromProps(this.props, this.state);\n  if (state !== null && state !== undefined) {\n    this.setState(state);\n  }\n}\n\nfunction componentWillReceiveProps(nextProps) {\n  // Call this.constructor.gDSFP to support sub-classes.\n  // Use the setState() updater to ensure state isn't stale in certain edge cases.\n  function updater(prevState) {\n    var state = this.constructor.getDerivedStateFromProps(nextProps, prevState);\n    return state !== null && state !== undefined ? state : null;\n  }\n  // Binding \"this\" is important for shallow renderer support.\n  this.setState(updater.bind(this));\n}\n\nfunction componentWillUpdate(nextProps, nextState) {\n  try {\n    var prevProps = this.props;\n    var prevState = this.state;\n    this.props = nextProps;\n    this.state = nextState;\n    this.__reactInternalSnapshotFlag = true;\n    this.__reactInternalSnapshot = this.getSnapshotBeforeUpdate(\n      prevProps,\n      prevState\n    );\n  } finally {\n    this.props = prevProps;\n    this.state = prevState;\n  }\n}\n\n// React may warn about cWM/cWRP/cWU methods being deprecated.\n// Add a flag to suppress these warnings for this special case.\ncomponentWillMount.__suppressDeprecationWarning = true;\ncomponentWillReceiveProps.__suppressDeprecationWarning = true;\ncomponentWillUpdate.__suppressDeprecationWarning = true;\n\nfunction polyfill(Component) {\n  var prototype = Component.prototype;\n\n  if (!prototype || !prototype.isReactComponent) {\n    throw new Error('Can only polyfill class components');\n  }\n\n  if (\n    typeof Component.getDerivedStateFromProps !== 'function' &&\n    typeof prototype.getSnapshotBeforeUpdate !== 'function'\n  ) {\n    return Component;\n  }\n\n  // If new component APIs are defined, \"unsafe\" lifecycles won't be called.\n  // Error if any of these lifecycles are present,\n  // Because they would work differently between older and newer (16.3+) versions of React.\n  var foundWillMountName = null;\n  var foundWillReceivePropsName = null;\n  var foundWillUpdateName = null;\n  if (typeof prototype.componentWillMount === 'function') {\n    foundWillMountName = 'componentWillMount';\n  } else if (typeof prototype.UNSAFE_componentWillMount === 'function') {\n    foundWillMountName = 'UNSAFE_componentWillMount';\n  }\n  if (typeof prototype.componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'componentWillReceiveProps';\n  } else if (typeof prototype.UNSAFE_componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'UNSAFE_componentWillReceiveProps';\n  }\n  if (typeof prototype.componentWillUpdate === 'function') {\n    foundWillUpdateName = 'componentWillUpdate';\n  } else if (typeof prototype.UNSAFE_componentWillUpdate === 'function') {\n    foundWillUpdateName = 'UNSAFE_componentWillUpdate';\n  }\n  if (\n    foundWillMountName !== null ||\n    foundWillReceivePropsName !== null ||\n    foundWillUpdateName !== null\n  ) {\n    var componentName = Component.displayName || Component.name;\n    var newApiName =\n      typeof Component.getDerivedStateFromProps === 'function'\n        ? 'getDerivedStateFromProps()'\n        : 'getSnapshotBeforeUpdate()';\n\n    throw Error(\n      'Unsafe legacy lifecycles will not be called for components using new component APIs.\\n\\n' +\n        componentName +\n        ' uses ' +\n        newApiName +\n        ' but also contains the following legacy lifecycles:' +\n        (foundWillMountName !== null ? '\\n  ' + foundWillMountName : '') +\n        (foundWillReceivePropsName !== null\n          ? '\\n  ' + foundWillReceivePropsName\n          : '') +\n        (foundWillUpdateName !== null ? '\\n  ' + foundWillUpdateName : '') +\n        '\\n\\nThe above lifecycles should be removed. Learn more about this warning here:\\n' +\n        'https://fb.me/react-async-component-lifecycle-hooks'\n    );\n  }\n\n  // React <= 16.2 does not support static getDerivedStateFromProps.\n  // As a workaround, use cWM and cWRP to invoke the new static lifecycle.\n  // Newer versions of React will ignore these lifecycles if gDSFP exists.\n  if (typeof Component.getDerivedStateFromProps === 'function') {\n    prototype.componentWillMount = componentWillMount;\n    prototype.componentWillReceiveProps = componentWillReceiveProps;\n  }\n\n  // React <= 16.2 does not support getSnapshotBeforeUpdate.\n  // As a workaround, use cWU to invoke the new lifecycle.\n  // Newer versions of React will ignore that lifecycle if gSBU exists.\n  if (typeof prototype.getSnapshotBeforeUpdate === 'function') {\n    if (typeof prototype.componentDidUpdate !== 'function') {\n      throw new Error(\n        'Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype'\n      );\n    }\n\n    prototype.componentWillUpdate = componentWillUpdate;\n\n    var componentDidUpdate = prototype.componentDidUpdate;\n\n    prototype.componentDidUpdate = function componentDidUpdatePolyfill(\n      prevProps,\n      prevState,\n      maybeSnapshot\n    ) {\n      // 16.3+ will not execute our will-update method;\n      // It will pass a snapshot value to did-update though.\n      // Older versions will require our polyfilled will-update value.\n      // We need to handle both cases, but can't just check for the presence of \"maybeSnapshot\",\n      // Because for <= 15.x versions this might be a \"prevContext\" object.\n      // We also can't just check \"__reactInternalSnapshot\",\n      // Because get-snapshot might return a falsy value.\n      // So check for the explicit __reactInternalSnapshotFlag flag to determine behavior.\n      var snapshot = this.__reactInternalSnapshotFlag\n        ? this.__reactInternalSnapshot\n        : maybeSnapshot;\n\n      componentDidUpdate.call(this, prevProps, prevState, snapshot);\n    };\n  }\n\n  return Component;\n}\n\nexport { polyfill };\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","var BitByte = require('./8BitByte');\nvar RSBlock = require('./RSBlock');\nvar BitBuffer = require('./BitBuffer');\nvar util = require('./util');\nvar Polynomial = require('./Polynomial');\n\nfunction QRCode(typeNumber, errorCorrectLevel) {\n\tthis.typeNumber = typeNumber;\n\tthis.errorCorrectLevel = errorCorrectLevel;\n\tthis.modules = null;\n\tthis.moduleCount = 0;\n\tthis.dataCache = null;\n\tthis.dataList = [];\n}\n\n// for client side minification\nvar proto = QRCode.prototype;\n\nproto.addData = function(data) {\n\tvar newData = new BitByte(data);\n\tthis.dataList.push(newData);\n\tthis.dataCache = null;\n};\n\nproto.isDark = function(row, col) {\n\tif (row < 0 || this.moduleCount <= row || col < 0 || this.moduleCount <= col) {\n\t\tthrow new Error(row + \",\" + col);\n\t}\n\treturn this.modules[row][col];\n};\n\nproto.getModuleCount = function() {\n\treturn this.moduleCount;\n};\n\nproto.make = function() {\n\t// Calculate automatically typeNumber if provided is < 1\n\tif (this.typeNumber < 1 ){\n\t\tvar typeNumber = 1;\n\t\tfor (typeNumber = 1; typeNumber < 40; typeNumber++) {\n\t\t\tvar rsBlocks = RSBlock.getRSBlocks(typeNumber, this.errorCorrectLevel);\n\n\t\t\tvar buffer = new BitBuffer();\n\t\t\tvar totalDataCount = 0;\n\t\t\tfor (var i = 0; i < rsBlocks.length; i++) {\n\t\t\t\ttotalDataCount += rsBlocks[i].dataCount;\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < this.dataList.length; i++) {\n\t\t\t\tvar data = this.dataList[i];\n\t\t\t\tbuffer.put(data.mode, 4);\n\t\t\t\tbuffer.put(data.getLength(), util.getLengthInBits(data.mode, typeNumber) );\n\t\t\t\tdata.write(buffer);\n\t\t\t}\n\t\t\tif (buffer.getLengthInBits() <= totalDataCount * 8)\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.typeNumber = typeNumber;\n\t}\n\tthis.makeImpl(false, this.getBestMaskPattern() );\n};\n\nproto.makeImpl = function(test, maskPattern) {\n\t\n\tthis.moduleCount = this.typeNumber * 4 + 17;\n\tthis.modules = new Array(this.moduleCount);\n\t\n\tfor (var row = 0; row < this.moduleCount; row++) {\n\t\t\n\t\tthis.modules[row] = new Array(this.moduleCount);\n\t\t\n\t\tfor (var col = 0; col < this.moduleCount; col++) {\n\t\t\tthis.modules[row][col] = null;//(col + row) % 3;\n\t\t}\n\t}\n\n\tthis.setupPositionProbePattern(0, 0);\n\tthis.setupPositionProbePattern(this.moduleCount - 7, 0);\n\tthis.setupPositionProbePattern(0, this.moduleCount - 7);\n\tthis.setupPositionAdjustPattern();\n\tthis.setupTimingPattern();\n\tthis.setupTypeInfo(test, maskPattern);\n\t\n\tif (this.typeNumber >= 7) {\n\t\tthis.setupTypeNumber(test);\n\t}\n\n\tif (this.dataCache == null) {\n\t\tthis.dataCache = QRCode.createData(this.typeNumber, this.errorCorrectLevel, this.dataList);\n\t}\n\n\tthis.mapData(this.dataCache, maskPattern);\n};\n\nproto.setupPositionProbePattern = function(row, col)  {\n\t\n\tfor (var r = -1; r <= 7; r++) {\n\t\t\n\t\tif (row + r <= -1 || this.moduleCount <= row + r) continue;\n\t\t\n\t\tfor (var c = -1; c <= 7; c++) {\n\t\t\t\n\t\t\tif (col + c <= -1 || this.moduleCount <= col + c) continue;\n\t\t\t\n\t\t\tif ( (0 <= r && r <= 6 && (c == 0 || c == 6) )\n\t\t\t\t\t|| (0 <= c && c <= 6 && (r == 0 || r == 6) )\n\t\t\t\t\t|| (2 <= r && r <= 4 && 2 <= c && c <= 4) ) {\n\t\t\t\tthis.modules[row + r][col + c] = true;\n\t\t\t} else {\n\t\t\t\tthis.modules[row + r][col + c] = false;\n\t\t\t}\n\t\t}\t\t\n\t}\t\t\n};\n\nproto.getBestMaskPattern = function() {\n\n\tvar minLostPoint = 0;\n\tvar pattern = 0;\n\n\tfor (var i = 0; i < 8; i++) {\n\t\t\n\t\tthis.makeImpl(true, i);\n\n\t\tvar lostPoint = util.getLostPoint(this);\n\n\t\tif (i == 0 || minLostPoint >  lostPoint) {\n\t\t\tminLostPoint = lostPoint;\n\t\t\tpattern = i;\n\t\t}\n\t}\n\n\treturn pattern;\n};\n\nproto.createMovieClip = function(target_mc, instance_name, depth) {\n\n\tvar qr_mc = target_mc.createEmptyMovieClip(instance_name, depth);\n\tvar cs = 1;\n\n\tthis.make();\n\n\tfor (var row = 0; row < this.modules.length; row++) {\n\t\t\n\t\tvar y = row * cs;\n\t\t\n\t\tfor (var col = 0; col < this.modules[row].length; col++) {\n\n\t\t\tvar x = col * cs;\n\t\t\tvar dark = this.modules[row][col];\n\t\t\n\t\t\tif (dark) {\n\t\t\t\tqr_mc.beginFill(0, 100);\n\t\t\t\tqr_mc.moveTo(x, y);\n\t\t\t\tqr_mc.lineTo(x + cs, y);\n\t\t\t\tqr_mc.lineTo(x + cs, y + cs);\n\t\t\t\tqr_mc.lineTo(x, y + cs);\n\t\t\t\tqr_mc.endFill();\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn qr_mc;\n};\n\nproto.setupTimingPattern = function() {\n\t\n\tfor (var r = 8; r < this.moduleCount - 8; r++) {\n\t\tif (this.modules[r][6] != null) {\n\t\t\tcontinue;\n\t\t}\n\t\tthis.modules[r][6] = (r % 2 == 0);\n\t}\n\n\tfor (var c = 8; c < this.moduleCount - 8; c++) {\n\t\tif (this.modules[6][c] != null) {\n\t\t\tcontinue;\n\t\t}\n\t\tthis.modules[6][c] = (c % 2 == 0);\n\t}\n};\n\nproto.setupPositionAdjustPattern = function() {\n\n\tvar pos = util.getPatternPosition(this.typeNumber);\n\t\n\tfor (var i = 0; i < pos.length; i++) {\n\t\n\t\tfor (var j = 0; j < pos.length; j++) {\n\t\t\n\t\t\tvar row = pos[i];\n\t\t\tvar col = pos[j];\n\t\t\t\n\t\t\tif (this.modules[row][col] != null) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tfor (var r = -2; r <= 2; r++) {\n\t\t\t\n\t\t\t\tfor (var c = -2; c <= 2; c++) {\n\t\t\t\t\n\t\t\t\t\tif (r == -2 || r == 2 || c == -2 || c == 2\n\t\t\t\t\t\t\t|| (r == 0 && c == 0) ) {\n\t\t\t\t\t\tthis.modules[row + r][col + c] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.modules[row + r][col + c] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nproto.setupTypeNumber = function(test) {\n\n\tvar bits = util.getBCHTypeNumber(this.typeNumber);\n\n\tfor (var i = 0; i < 18; i++) {\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\t\tthis.modules[Math.floor(i / 3)][i % 3 + this.moduleCount - 8 - 3] = mod;\n\t}\n\n\tfor (var i = 0; i < 18; i++) {\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\t\tthis.modules[i % 3 + this.moduleCount - 8 - 3][Math.floor(i / 3)] = mod;\n\t}\n};\n\nproto.setupTypeInfo = function(test, maskPattern) {\n\n\tvar data = (this.errorCorrectLevel << 3) | maskPattern;\n\tvar bits = util.getBCHTypeInfo(data);\n\n\t// vertical\t\t\n\tfor (var i = 0; i < 15; i++) {\n\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\n\t\tif (i < 6) {\n\t\t\tthis.modules[i][8] = mod;\n\t\t} else if (i < 8) {\n\t\t\tthis.modules[i + 1][8] = mod;\n\t\t} else {\n\t\t\tthis.modules[this.moduleCount - 15 + i][8] = mod;\n\t\t}\n\t}\n\n\t// horizontal\n\tfor (var i = 0; i < 15; i++) {\n\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\t\t\n\t\tif (i < 8) {\n\t\t\tthis.modules[8][this.moduleCount - i - 1] = mod;\n\t\t} else if (i < 9) {\n\t\t\tthis.modules[8][15 - i - 1 + 1] = mod;\n\t\t} else {\n\t\t\tthis.modules[8][15 - i - 1] = mod;\n\t\t}\n\t}\n\n\t// fixed module\n\tthis.modules[this.moduleCount - 8][8] = (!test);\n};\n\nproto.mapData = function(data, maskPattern) {\n\t\n\tvar inc = -1;\n\tvar row = this.moduleCount - 1;\n\tvar bitIndex = 7;\n\tvar byteIndex = 0;\n\t\n\tfor (var col = this.moduleCount - 1; col > 0; col -= 2) {\n\n\t\tif (col == 6) col--;\n\n\t\twhile (true) {\n\n\t\t\tfor (var c = 0; c < 2; c++) {\n\t\t\t\t\n\t\t\t\tif (this.modules[row][col - c] == null) {\n\t\t\t\t\t\n\t\t\t\t\tvar dark = false;\n\n\t\t\t\t\tif (byteIndex < data.length) {\n\t\t\t\t\t\tdark = ( ( (data[byteIndex] >>> bitIndex) & 1) == 1);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar mask = util.getMask(maskPattern, row, col - c);\n\n\t\t\t\t\tif (mask) {\n\t\t\t\t\t\tdark = !dark;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.modules[row][col - c] = dark;\n\t\t\t\t\tbitIndex--;\n\n\t\t\t\t\tif (bitIndex == -1) {\n\t\t\t\t\t\tbyteIndex++;\n\t\t\t\t\t\tbitIndex = 7;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\trow += inc;\n\n\t\t\tif (row < 0 || this.moduleCount <= row) {\n\t\t\t\trow -= inc;\n\t\t\t\tinc = -inc;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n};\n\nQRCode.PAD0 = 0xEC;\nQRCode.PAD1 = 0x11;\n\nQRCode.createData = function(typeNumber, errorCorrectLevel, dataList) {\n\t\n\tvar rsBlocks = RSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\n\t\n\tvar buffer = new BitBuffer();\n\t\n\tfor (var i = 0; i < dataList.length; i++) {\n\t\tvar data = dataList[i];\n\t\tbuffer.put(data.mode, 4);\n\t\tbuffer.put(data.getLength(), util.getLengthInBits(data.mode, typeNumber) );\n\t\tdata.write(buffer);\n\t}\n\n\t// calc num max data.\n\tvar totalDataCount = 0;\n\tfor (var i = 0; i < rsBlocks.length; i++) {\n\t\ttotalDataCount += rsBlocks[i].dataCount;\n\t}\n\n\tif (buffer.getLengthInBits() > totalDataCount * 8) {\n\t\tthrow new Error(\"code length overflow. (\"\n\t\t\t+ buffer.getLengthInBits()\n\t\t\t+ \">\"\n\t\t\t+  totalDataCount * 8\n\t\t\t+ \")\");\n\t}\n\n\t// end code\n\tif (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n\t\tbuffer.put(0, 4);\n\t}\n\n\t// padding\n\twhile (buffer.getLengthInBits() % 8 != 0) {\n\t\tbuffer.putBit(false);\n\t}\n\n\t// padding\n\twhile (true) {\n\t\t\n\t\tif (buffer.getLengthInBits() >= totalDataCount * 8) {\n\t\t\tbreak;\n\t\t}\n\t\tbuffer.put(QRCode.PAD0, 8);\n\t\t\n\t\tif (buffer.getLengthInBits() >= totalDataCount * 8) {\n\t\t\tbreak;\n\t\t}\n\t\tbuffer.put(QRCode.PAD1, 8);\n\t}\n\n\treturn QRCode.createBytes(buffer, rsBlocks);\n};\n\nQRCode.createBytes = function(buffer, rsBlocks) {\n\n\tvar offset = 0;\n\t\n\tvar maxDcCount = 0;\n\tvar maxEcCount = 0;\n\t\n\tvar dcdata = new Array(rsBlocks.length);\n\tvar ecdata = new Array(rsBlocks.length);\n\t\n\tfor (var r = 0; r < rsBlocks.length; r++) {\n\n\t\tvar dcCount = rsBlocks[r].dataCount;\n\t\tvar ecCount = rsBlocks[r].totalCount - dcCount;\n\n\t\tmaxDcCount = Math.max(maxDcCount, dcCount);\n\t\tmaxEcCount = Math.max(maxEcCount, ecCount);\n\t\t\n\t\tdcdata[r] = new Array(dcCount);\n\t\t\n\t\tfor (var i = 0; i < dcdata[r].length; i++) {\n\t\t\tdcdata[r][i] = 0xff & buffer.buffer[i + offset];\n\t\t}\n\t\toffset += dcCount;\n\t\t\n\t\tvar rsPoly = util.getErrorCorrectPolynomial(ecCount);\n\t\tvar rawPoly = new Polynomial(dcdata[r], rsPoly.getLength() - 1);\n\n\t\tvar modPoly = rawPoly.mod(rsPoly);\n\t\tecdata[r] = new Array(rsPoly.getLength() - 1);\n\t\tfor (var i = 0; i < ecdata[r].length; i++) {\n            var modIndex = i + modPoly.getLength() - ecdata[r].length;\n\t\t\tecdata[r][i] = (modIndex >= 0)? modPoly.get(modIndex) : 0;\n\t\t}\n\n\t}\n\t\n\tvar totalCodeCount = 0;\n\tfor (var i = 0; i < rsBlocks.length; i++) {\n\t\ttotalCodeCount += rsBlocks[i].totalCount;\n\t}\n\n\tvar data = new Array(totalCodeCount);\n\tvar index = 0;\n\n\tfor (var i = 0; i < maxDcCount; i++) {\n\t\tfor (var r = 0; r < rsBlocks.length; r++) {\n\t\t\tif (i < dcdata[r].length) {\n\t\t\t\tdata[index++] = dcdata[r][i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (var i = 0; i < maxEcCount; i++) {\n\t\tfor (var r = 0; r < rsBlocks.length; r++) {\n\t\t\tif (i < ecdata[r].length) {\n\t\t\t\tdata[index++] = ecdata[r][i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn data;\n};\n\nmodule.exports = QRCode;\n\n","var mode = require('./mode');\n\nfunction QR8bitByte(data) {\n\tthis.mode = mode.MODE_8BIT_BYTE;\n\tthis.data = data;\n}\n\nQR8bitByte.prototype = {\n\n\tgetLength : function(buffer) {\n\t\treturn this.data.length;\n\t},\n\t\n\twrite : function(buffer) {\n\t\tfor (var i = 0; i < this.data.length; i++) {\n\t\t\t// not JIS ...\n\t\t\tbuffer.put(this.data.charCodeAt(i), 8);\n\t\t}\n\t}\n};\n\nmodule.exports = QR8bitByte;\n\n","// ErrorCorrectLevel\nvar ECL = require('./ErrorCorrectLevel');\n\nfunction QRRSBlock(totalCount, dataCount) {\n\tthis.totalCount = totalCount;\n\tthis.dataCount  = dataCount;\n}\n\nQRRSBlock.RS_BLOCK_TABLE = [\n\n\t// L\n\t// M\n\t// Q\n\t// H\n\n\t// 1\n\t[1, 26, 19],\n\t[1, 26, 16],\n\t[1, 26, 13],\n\t[1, 26, 9],\n\t\n\t// 2\n\t[1, 44, 34],\n\t[1, 44, 28],\n\t[1, 44, 22],\n\t[1, 44, 16],\n\n\t// 3\n\t[1, 70, 55],\n\t[1, 70, 44],\n\t[2, 35, 17],\n\t[2, 35, 13],\n\n\t// 4\t\t\n\t[1, 100, 80],\n\t[2, 50, 32],\n\t[2, 50, 24],\n\t[4, 25, 9],\n\t\n\t// 5\n\t[1, 134, 108],\n\t[2, 67, 43],\n\t[2, 33, 15, 2, 34, 16],\n\t[2, 33, 11, 2, 34, 12],\n\t\n\t// 6\n\t[2, 86, 68],\n\t[4, 43, 27],\n\t[4, 43, 19],\n\t[4, 43, 15],\n\t\n\t// 7\t\t\n\t[2, 98, 78],\n\t[4, 49, 31],\n\t[2, 32, 14, 4, 33, 15],\n\t[4, 39, 13, 1, 40, 14],\n\t\n\t// 8\n\t[2, 121, 97],\n\t[2, 60, 38, 2, 61, 39],\n\t[4, 40, 18, 2, 41, 19],\n\t[4, 40, 14, 2, 41, 15],\n\t\n\t// 9\n\t[2, 146, 116],\n\t[3, 58, 36, 2, 59, 37],\n\t[4, 36, 16, 4, 37, 17],\n\t[4, 36, 12, 4, 37, 13],\n\t\n\t// 10\t\t\n\t[2, 86, 68, 2, 87, 69],\n\t[4, 69, 43, 1, 70, 44],\n\t[6, 43, 19, 2, 44, 20],\n\t[6, 43, 15, 2, 44, 16],\n\n\t// 11\n\t[4, 101, 81],\n\t[1, 80, 50, 4, 81, 51],\n\t[4, 50, 22, 4, 51, 23],\n\t[3, 36, 12, 8, 37, 13],\n\n\t// 12\n\t[2, 116, 92, 2, 117, 93],\n\t[6, 58, 36, 2, 59, 37],\n\t[4, 46, 20, 6, 47, 21],\n\t[7, 42, 14, 4, 43, 15],\n\n\t// 13\n\t[4, 133, 107],\n\t[8, 59, 37, 1, 60, 38],\n\t[8, 44, 20, 4, 45, 21],\n\t[12, 33, 11, 4, 34, 12],\n\n\t// 14\n\t[3, 145, 115, 1, 146, 116],\n\t[4, 64, 40, 5, 65, 41],\n\t[11, 36, 16, 5, 37, 17],\n\t[11, 36, 12, 5, 37, 13],\n\n\t// 15\n\t[5, 109, 87, 1, 110, 88],\n\t[5, 65, 41, 5, 66, 42],\n\t[5, 54, 24, 7, 55, 25],\n\t[11, 36, 12],\n\n\t// 16\n\t[5, 122, 98, 1, 123, 99],\n\t[7, 73, 45, 3, 74, 46],\n\t[15, 43, 19, 2, 44, 20],\n\t[3, 45, 15, 13, 46, 16],\n\n\t// 17\n\t[1, 135, 107, 5, 136, 108],\n\t[10, 74, 46, 1, 75, 47],\n\t[1, 50, 22, 15, 51, 23],\n\t[2, 42, 14, 17, 43, 15],\n\n\t// 18\n\t[5, 150, 120, 1, 151, 121],\n\t[9, 69, 43, 4, 70, 44],\n\t[17, 50, 22, 1, 51, 23],\n\t[2, 42, 14, 19, 43, 15],\n\n\t// 19\n\t[3, 141, 113, 4, 142, 114],\n\t[3, 70, 44, 11, 71, 45],\n\t[17, 47, 21, 4, 48, 22],\n\t[9, 39, 13, 16, 40, 14],\n\n\t// 20\n\t[3, 135, 107, 5, 136, 108],\n\t[3, 67, 41, 13, 68, 42],\n\t[15, 54, 24, 5, 55, 25],\n\t[15, 43, 15, 10, 44, 16],\n\n\t// 21\n\t[4, 144, 116, 4, 145, 117],\n\t[17, 68, 42],\n\t[17, 50, 22, 6, 51, 23],\n\t[19, 46, 16, 6, 47, 17],\n\n\t// 22\n\t[2, 139, 111, 7, 140, 112],\n\t[17, 74, 46],\n\t[7, 54, 24, 16, 55, 25],\n\t[34, 37, 13],\n\n\t// 23\n\t[4, 151, 121, 5, 152, 122],\n\t[4, 75, 47, 14, 76, 48],\n\t[11, 54, 24, 14, 55, 25],\n\t[16, 45, 15, 14, 46, 16],\n\n\t// 24\n\t[6, 147, 117, 4, 148, 118],\n\t[6, 73, 45, 14, 74, 46],\n\t[11, 54, 24, 16, 55, 25],\n\t[30, 46, 16, 2, 47, 17],\n\n\t// 25\n\t[8, 132, 106, 4, 133, 107],\n\t[8, 75, 47, 13, 76, 48],\n\t[7, 54, 24, 22, 55, 25],\n\t[22, 45, 15, 13, 46, 16],\n\n\t// 26\n\t[10, 142, 114, 2, 143, 115],\n\t[19, 74, 46, 4, 75, 47],\n\t[28, 50, 22, 6, 51, 23],\n\t[33, 46, 16, 4, 47, 17],\n\n\t// 27\n\t[8, 152, 122, 4, 153, 123],\n\t[22, 73, 45, 3, 74, 46],\n\t[8, 53, 23, 26, 54, 24],\n\t[12, 45, 15, 28, 46, 16],\n\n\t// 28\n\t[3, 147, 117, 10, 148, 118],\n\t[3, 73, 45, 23, 74, 46],\n\t[4, 54, 24, 31, 55, 25],\n\t[11, 45, 15, 31, 46, 16],\n\n\t// 29\n\t[7, 146, 116, 7, 147, 117],\n\t[21, 73, 45, 7, 74, 46],\n\t[1, 53, 23, 37, 54, 24],\n\t[19, 45, 15, 26, 46, 16],\n\n\t// 30\n\t[5, 145, 115, 10, 146, 116],\n\t[19, 75, 47, 10, 76, 48],\n\t[15, 54, 24, 25, 55, 25],\n\t[23, 45, 15, 25, 46, 16],\n\n\t// 31\n\t[13, 145, 115, 3, 146, 116],\n\t[2, 74, 46, 29, 75, 47],\n\t[42, 54, 24, 1, 55, 25],\n\t[23, 45, 15, 28, 46, 16],\n\n\t// 32\n\t[17, 145, 115],\n\t[10, 74, 46, 23, 75, 47],\n\t[10, 54, 24, 35, 55, 25],\n\t[19, 45, 15, 35, 46, 16],\n\n\t// 33\n\t[17, 145, 115, 1, 146, 116],\n\t[14, 74, 46, 21, 75, 47],\n\t[29, 54, 24, 19, 55, 25],\n\t[11, 45, 15, 46, 46, 16],\n\n\t// 34\n\t[13, 145, 115, 6, 146, 116],\n\t[14, 74, 46, 23, 75, 47],\n\t[44, 54, 24, 7, 55, 25],\n\t[59, 46, 16, 1, 47, 17],\n\n\t// 35\n\t[12, 151, 121, 7, 152, 122],\n\t[12, 75, 47, 26, 76, 48],\n\t[39, 54, 24, 14, 55, 25],\n\t[22, 45, 15, 41, 46, 16],\n\n\t// 36\n\t[6, 151, 121, 14, 152, 122],\n\t[6, 75, 47, 34, 76, 48],\n\t[46, 54, 24, 10, 55, 25],\n\t[2, 45, 15, 64, 46, 16],\n\n\t// 37\n\t[17, 152, 122, 4, 153, 123],\n\t[29, 74, 46, 14, 75, 47],\n\t[49, 54, 24, 10, 55, 25],\n\t[24, 45, 15, 46, 46, 16],\n\n\t// 38\n\t[4, 152, 122, 18, 153, 123],\n\t[13, 74, 46, 32, 75, 47],\n\t[48, 54, 24, 14, 55, 25],\n\t[42, 45, 15, 32, 46, 16],\n\n\t// 39\n\t[20, 147, 117, 4, 148, 118],\n\t[40, 75, 47, 7, 76, 48],\n\t[43, 54, 24, 22, 55, 25],\n\t[10, 45, 15, 67, 46, 16],\n\n\t// 40\n\t[19, 148, 118, 6, 149, 119],\n\t[18, 75, 47, 31, 76, 48],\n\t[34, 54, 24, 34, 55, 25],\n\t[20, 45, 15, 61, 46, 16]\n];\n\nQRRSBlock.getRSBlocks = function(typeNumber, errorCorrectLevel) {\n\t\n\tvar rsBlock = QRRSBlock.getRsBlockTable(typeNumber, errorCorrectLevel);\n\t\n\tif (rsBlock == undefined) {\n\t\tthrow new Error(\"bad rs block @ typeNumber:\" + typeNumber + \"/errorCorrectLevel:\" + errorCorrectLevel);\n\t}\n\n\tvar length = rsBlock.length / 3;\n\t\n\tvar list = new Array();\n\t\n\tfor (var i = 0; i < length; i++) {\n\n\t\tvar count = rsBlock[i * 3 + 0];\n\t\tvar totalCount = rsBlock[i * 3 + 1];\n\t\tvar dataCount  = rsBlock[i * 3 + 2];\n\n\t\tfor (var j = 0; j < count; j++) {\n\t\t\tlist.push(new QRRSBlock(totalCount, dataCount) );\t\n\t\t}\n\t}\n\t\n\treturn list;\n}\n\nQRRSBlock.getRsBlockTable = function(typeNumber, errorCorrectLevel) {\n\n\tswitch(errorCorrectLevel) {\n\tcase ECL.L :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n\tcase ECL.M :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n\tcase ECL.Q :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n\tcase ECL.H :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n\tdefault :\n\t\treturn undefined;\n\t}\n}\n\nmodule.exports = QRRSBlock;\n","function QRBitBuffer() {\n\tthis.buffer = new Array();\n\tthis.length = 0;\n}\n\nQRBitBuffer.prototype = {\n\n\tget : function(index) {\n\t\tvar bufIndex = Math.floor(index / 8);\n\t\treturn ( (this.buffer[bufIndex] >>> (7 - index % 8) ) & 1) == 1;\n\t},\n\t\n\tput : function(num, length) {\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tthis.putBit( ( (num >>> (length - i - 1) ) & 1) == 1);\n\t\t}\n\t},\n\t\n\tgetLengthInBits : function() {\n\t\treturn this.length;\n\t},\n\t\n\tputBit : function(bit) {\n\t\n\t\tvar bufIndex = Math.floor(this.length / 8);\n\t\tif (this.buffer.length <= bufIndex) {\n\t\t\tthis.buffer.push(0);\n\t\t}\n\t\n\t\tif (bit) {\n\t\t\tthis.buffer[bufIndex] |= (0x80 >>> (this.length % 8) );\n\t\t}\n\t\n\t\tthis.length++;\n\t}\n};\n\nmodule.exports = QRBitBuffer;\n","var Mode = require('./mode');\nvar Polynomial = require('./Polynomial');\nvar math = require('./math');\n\nvar QRMaskPattern = {\n\tPATTERN000 : 0,\n\tPATTERN001 : 1,\n\tPATTERN010 : 2,\n\tPATTERN011 : 3,\n\tPATTERN100 : 4,\n\tPATTERN101 : 5,\n\tPATTERN110 : 6,\n\tPATTERN111 : 7\n};\n\nvar QRUtil = {\n\n    PATTERN_POSITION_TABLE : [\n\t    [],\n\t    [6, 18],\n\t    [6, 22],\n\t    [6, 26],\n\t    [6, 30],\n\t    [6, 34],\n\t    [6, 22, 38],\n\t    [6, 24, 42],\n\t    [6, 26, 46],\n\t    [6, 28, 50],\n\t    [6, 30, 54],\t\t\n\t    [6, 32, 58],\n\t    [6, 34, 62],\n\t    [6, 26, 46, 66],\n\t    [6, 26, 48, 70],\n\t    [6, 26, 50, 74],\n\t    [6, 30, 54, 78],\n\t    [6, 30, 56, 82],\n\t    [6, 30, 58, 86],\n\t    [6, 34, 62, 90],\n\t    [6, 28, 50, 72, 94],\n\t    [6, 26, 50, 74, 98],\n\t    [6, 30, 54, 78, 102],\n\t    [6, 28, 54, 80, 106],\n\t    [6, 32, 58, 84, 110],\n\t    [6, 30, 58, 86, 114],\n\t    [6, 34, 62, 90, 118],\n\t    [6, 26, 50, 74, 98, 122],\n\t    [6, 30, 54, 78, 102, 126],\n\t    [6, 26, 52, 78, 104, 130],\n\t    [6, 30, 56, 82, 108, 134],\n\t    [6, 34, 60, 86, 112, 138],\n\t    [6, 30, 58, 86, 114, 142],\n\t    [6, 34, 62, 90, 118, 146],\n\t    [6, 30, 54, 78, 102, 126, 150],\n\t    [6, 24, 50, 76, 102, 128, 154],\n\t    [6, 28, 54, 80, 106, 132, 158],\n\t    [6, 32, 58, 84, 110, 136, 162],\n\t    [6, 26, 54, 82, 110, 138, 166],\n\t    [6, 30, 58, 86, 114, 142, 170]\n    ],\n\n    G15 : (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0),\n    G18 : (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0),\n    G15_MASK : (1 << 14) | (1 << 12) | (1 << 10)\t| (1 << 4) | (1 << 1),\n\n    getBCHTypeInfo : function(data) {\n\t    var d = data << 10;\n\t    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) >= 0) {\n\t\t    d ^= (QRUtil.G15 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) ) ); \t\n\t    }\n\t    return ( (data << 10) | d) ^ QRUtil.G15_MASK;\n    },\n\n    getBCHTypeNumber : function(data) {\n\t    var d = data << 12;\n\t    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) >= 0) {\n\t\t    d ^= (QRUtil.G18 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) ) ); \t\n\t    }\n\t    return (data << 12) | d;\n    },\n\n    getBCHDigit : function(data) {\n\n\t    var digit = 0;\n\n\t    while (data != 0) {\n\t\t    digit++;\n\t\t    data >>>= 1;\n\t    }\n\n\t    return digit;\n    },\n\n    getPatternPosition : function(typeNumber) {\n\t    return QRUtil.PATTERN_POSITION_TABLE[typeNumber - 1];\n    },\n\n    getMask : function(maskPattern, i, j) {\n\t    \n\t    switch (maskPattern) {\n\t\t    \n\t    case QRMaskPattern.PATTERN000 : return (i + j) % 2 == 0;\n\t    case QRMaskPattern.PATTERN001 : return i % 2 == 0;\n\t    case QRMaskPattern.PATTERN010 : return j % 3 == 0;\n\t    case QRMaskPattern.PATTERN011 : return (i + j) % 3 == 0;\n\t    case QRMaskPattern.PATTERN100 : return (Math.floor(i / 2) + Math.floor(j / 3) ) % 2 == 0;\n\t    case QRMaskPattern.PATTERN101 : return (i * j) % 2 + (i * j) % 3 == 0;\n\t    case QRMaskPattern.PATTERN110 : return ( (i * j) % 2 + (i * j) % 3) % 2 == 0;\n\t    case QRMaskPattern.PATTERN111 : return ( (i * j) % 3 + (i + j) % 2) % 2 == 0;\n\n\t    default :\n\t\t    throw new Error(\"bad maskPattern:\" + maskPattern);\n\t    }\n    },\n\n    getErrorCorrectPolynomial : function(errorCorrectLength) {\n\n\t    var a = new Polynomial([1], 0);\n\n\t    for (var i = 0; i < errorCorrectLength; i++) {\n\t\t    a = a.multiply(new Polynomial([1, math.gexp(i)], 0) );\n\t    }\n\n\t    return a;\n    },\n\n    getLengthInBits : function(mode, type) {\n\n\t    if (1 <= type && type < 10) {\n\n\t\t    // 1 - 9\n\n\t\t    switch(mode) {\n\t\t    case Mode.MODE_NUMBER \t: return 10;\n\t\t    case Mode.MODE_ALPHA_NUM \t: return 9;\n\t\t    case Mode.MODE_8BIT_BYTE\t: return 8;\n\t\t    case Mode.MODE_KANJI  \t: return 8;\n\t\t    default :\n\t\t\t    throw new Error(\"mode:\" + mode);\n\t\t    }\n\n\t    } else if (type < 27) {\n\n\t\t    // 10 - 26\n\n\t\t    switch(mode) {\n\t\t    case Mode.MODE_NUMBER \t: return 12;\n\t\t    case Mode.MODE_ALPHA_NUM \t: return 11;\n\t\t    case Mode.MODE_8BIT_BYTE\t: return 16;\n\t\t    case Mode.MODE_KANJI  \t: return 10;\n\t\t    default :\n\t\t\t    throw new Error(\"mode:\" + mode);\n\t\t    }\n\n\t    } else if (type < 41) {\n\n\t\t    // 27 - 40\n\n\t\t    switch(mode) {\n\t\t    case Mode.MODE_NUMBER \t: return 14;\n\t\t    case Mode.MODE_ALPHA_NUM\t: return 13;\n\t\t    case Mode.MODE_8BIT_BYTE\t: return 16;\n\t\t    case Mode.MODE_KANJI  \t: return 12;\n\t\t    default :\n\t\t\t    throw new Error(\"mode:\" + mode);\n\t\t    }\n\n\t    } else {\n\t\t    throw new Error(\"type:\" + type);\n\t    }\n    },\n\n    getLostPoint : function(qrCode) {\n\t    \n\t    var moduleCount = qrCode.getModuleCount();\n\t    \n\t    var lostPoint = 0;\n\t    \n\t    // LEVEL1\n\t    \n\t    for (var row = 0; row < moduleCount; row++) {\n\n\t\t    for (var col = 0; col < moduleCount; col++) {\n\n\t\t\t    var sameCount = 0;\n\t\t\t    var dark = qrCode.isDark(row, col);\n\n\t\t\t\tfor (var r = -1; r <= 1; r++) {\n\n\t\t\t\t    if (row + r < 0 || moduleCount <= row + r) {\n\t\t\t\t\t    continue;\n\t\t\t\t    }\n\n\t\t\t\t    for (var c = -1; c <= 1; c++) {\n\n\t\t\t\t\t    if (col + c < 0 || moduleCount <= col + c) {\n\t\t\t\t\t\t    continue;\n\t\t\t\t\t    }\n\n\t\t\t\t\t    if (r == 0 && c == 0) {\n\t\t\t\t\t\t    continue;\n\t\t\t\t\t    }\n\n\t\t\t\t\t    if (dark == qrCode.isDark(row + r, col + c) ) {\n\t\t\t\t\t\t    sameCount++;\n\t\t\t\t\t    }\n\t\t\t\t    }\n\t\t\t    }\n\n\t\t\t    if (sameCount > 5) {\n\t\t\t\t    lostPoint += (3 + sameCount - 5);\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    // LEVEL2\n\n\t    for (var row = 0; row < moduleCount - 1; row++) {\n\t\t    for (var col = 0; col < moduleCount - 1; col++) {\n\t\t\t    var count = 0;\n\t\t\t    if (qrCode.isDark(row,     col    ) ) count++;\n\t\t\t    if (qrCode.isDark(row + 1, col    ) ) count++;\n\t\t\t    if (qrCode.isDark(row,     col + 1) ) count++;\n\t\t\t    if (qrCode.isDark(row + 1, col + 1) ) count++;\n\t\t\t    if (count == 0 || count == 4) {\n\t\t\t\t    lostPoint += 3;\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    // LEVEL3\n\n\t    for (var row = 0; row < moduleCount; row++) {\n\t\t    for (var col = 0; col < moduleCount - 6; col++) {\n\t\t\t    if (qrCode.isDark(row, col)\n\t\t\t\t\t    && !qrCode.isDark(row, col + 1)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 2)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 3)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 4)\n\t\t\t\t\t    && !qrCode.isDark(row, col + 5)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 6) ) {\n\t\t\t\t    lostPoint += 40;\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    for (var col = 0; col < moduleCount; col++) {\n\t\t    for (var row = 0; row < moduleCount - 6; row++) {\n\t\t\t    if (qrCode.isDark(row, col)\n\t\t\t\t\t    && !qrCode.isDark(row + 1, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 2, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 3, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 4, col)\n\t\t\t\t\t    && !qrCode.isDark(row + 5, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 6, col) ) {\n\t\t\t\t    lostPoint += 40;\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    // LEVEL4\n\t    \n\t    var darkCount = 0;\n\n\t    for (var col = 0; col < moduleCount; col++) {\n\t\t    for (var row = 0; row < moduleCount; row++) {\n\t\t\t    if (qrCode.isDark(row, col) ) {\n\t\t\t\t    darkCount++;\n\t\t\t    }\n\t\t    }\n\t    }\n\t    \n\t    var ratio = Math.abs(100 * darkCount / moduleCount / moduleCount - 50) / 5;\n\t    lostPoint += ratio * 10;\n\n\t    return lostPoint;\t\t\n    }\n};\n\nmodule.exports = QRUtil;\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n"],"sourceRoot":""}